Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=False, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=False, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.14678  0.12349  0.27035  0.24356  0.25736  0.24185  0.00000  2.63508  2.29882  -0.0002  0        0.86478  0.26386  0.12349  3.36277 
0.70101  0.67152  0.99846  0.99914  0.97473  0.96312  11.5486  0.12403  0.09092  0.00754  2000     0.95474  0.98660  0.67152  0.32349 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09829  0.09691  0.10362  0.09519  0.10290  0.09862  0.00000  2.62255  2.28607  -0.0000  0        0.96022  0.10326  0.09691  3.36492 
0.68950  0.68096  0.99860  0.99656  0.97225  0.96569  11.5486  0.13384  0.09877  0.00798  2000     0.96276  0.98542  0.68096  0.34271 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09928  0.09948  0.10023  0.10120  0.09924  0.09176  0.00000  2.60486  2.27353  0.00034  0        0.96316  0.09974  0.09948  3.31297 
0.71697  0.69811  0.99846  0.99571  0.97302  0.96569  11.5486  0.12843  0.09422  0.00792  2000     0.99201  0.98574  0.69811  0.33414 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  2.75182  2.39954  0.01111  0        1.01032  0.10008  0.10463  3.51165 
0.69677  0.69468  0.99896  0.99914  0.97360  0.96397  11.5486  0.12405  0.09096  0.00755  2000     1.03377  0.98628  0.69468  0.32334 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  2.68143  2.34194  0.00275  0        0.99936  0.10360  0.10291  3.39213 
0.70466  0.69296  0.99842  0.99742  0.97302  0.96998  11.5486  0.12818  0.09404  0.00788  2000     1.02960  0.98572  0.69296  0.33354 
RRRRRRR ib_lambda:     0.10   irm_lambda:     0.10 val acc: 68.77 +- 0.99 test acc: 70.18 +- 0.91
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.14773  0.12349  0.27798  0.25557  0.26539  0.25214  0.00000  2.63488  2.29882  -0.0002  0        1.19050  0.27168  0.12349  3.36277 
0.67047  0.66209  0.99846  0.99914  0.97063  0.96054  11.5486  0.13602  0.09591  0.00583  2000     1.10669  0.98454  0.66209  0.34283 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09825  0.09691  0.10294  0.09348  0.10249  0.09862  0.00000  2.62251  2.28607  -0.0000  0        1.08998  0.10272  0.09691  3.36492 
0.67967  0.65952  0.99869  0.99742  0.97112  0.96655  11.5486  0.14079  0.09936  0.00650  2000     1.11792  0.98491  0.65952  0.34929 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09960  0.09948  0.10019  0.10120  0.09920  0.09176  0.00000  2.60517  2.27353  0.00034  0        1.08741  0.09969  0.09948  3.31297 
0.70024  0.66723  0.99855  0.99742  0.97121  0.96397  11.5486  0.13804  0.09673  0.00644  2000     1.00529  0.98488  0.66723  0.34866 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  2.76182  2.39954  0.01111  0        0.94596  0.10008  0.10463  3.51165 
0.65693  0.67152  0.99878  0.99914  0.96977  0.95969  11.5486  0.14056  0.09880  0.00650  2000     0.95592  0.98427  0.67152  0.35261 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10023  0.10205  0.10204  0.08061  0.10511  0.09519  0.00000  2.68390  2.34194  0.00275  0        0.94719  0.10357  0.10205  3.39213 
0.70033  0.70068  0.99824  0.99742  0.97333  0.96741  11.5486  0.13474  0.09474  0.00624  2000     0.96633  0.98579  0.70068  0.33764 
RRRRRRR ib_lambda:     0.10   irm_lambda:     1.00 val acc: 67.22 +- 1.48 test acc: 68.15 +- 1.69
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13483  0.12006  0.11535  0.10634  0.11742  0.10806  0.00000  0.54506  2.29882  -0.0002  0        0.95442  0.11638  0.12006  3.36277 
0.47857  0.46140  0.99810  0.99914  0.95100  0.94253  11.5486  0.06611  0.15415  0.00742  2000     1.12169  0.97455  0.46140  0.45345 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.54427  2.28607  -0.0000  0        1.06383  0.09757  0.09777  3.36492 
0.44690  0.43653  0.99788  0.99656  0.94591  0.93653  11.5486  0.07099  0.16785  0.00796  2000     1.06003  0.97189  0.43653  0.48495 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.53829  2.27353  0.00034  0        1.04029  0.09976  0.09948  3.31297 
0.44018  0.43310  0.99769  0.99828  0.94523  0.93996  11.5486  0.07339  0.17367  0.00842  2000     1.06081  0.97146  0.43310  0.49948 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.57940  2.39954  0.01111  0        1.28655  0.10008  0.10463  3.51165 
0.43174  0.43310  0.99797  0.99656  0.94586  0.93482  11.5486  0.07295  0.17524  0.00790  2000     1.10217  0.97191  0.43310  0.49839 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.55461  2.34194  0.00275  0        0.97621  0.10360  0.10291  3.39213 
0.43851  0.42624  0.99702  0.99742  0.94631  0.93825  11.5486  0.07147  0.17250  0.00766  2000     1.01541  0.97167  0.42624  0.48827 
RRRRRRR ib_lambda:     0.10   irm_lambda:    10.00 val acc: 43.81 +- 1.21 test acc: 44.72 +- 1.64
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13086  0.11663  0.10177  0.09090  0.10484  0.10034  0.00000  0.35882  2.29882  -0.0002  0        1.01469  0.10330  0.11663  3.36277 
0.38474  0.37221  0.99666  0.99914  0.94049  0.93396  11.5486  0.06579  0.20885  0.00845  2000     0.99779  0.96857  0.37221  0.55349 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.35907  2.28607  -0.0000  0        0.95362  0.09757  0.09777  3.36492 
0.39732  0.37564  0.99697  0.99656  0.94022  0.93310  11.5486  0.06760  0.22011  0.00814  2000     0.96224  0.96860  0.37564  0.57365 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.35414  2.27353  0.00034  0        0.96345  0.09976  0.09948  3.31297 
0.37211  0.35591  0.99625  0.99656  0.93648  0.93396  11.5486  0.07245  0.24506  0.00902  2000     0.96664  0.96636  0.35591  0.61088 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.38592  2.39954  0.01111  0        0.96543  0.10008  0.10463  3.51165 
0.37617  0.37993  0.99494  0.99399  0.93797  0.92538  11.5486  0.06793  0.22772  0.00817  2000     0.97241  0.96645  0.37993  0.57594 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.36512  2.34194  0.00275  0        0.95760  0.10360  0.10291  3.39213 
0.38303  0.37735  0.99594  0.99742  0.93851  0.93224  11.5486  0.06831  0.22688  0.00835  2000     0.96930  0.96722  0.37735  0.57794 
RRRRRRR ib_lambda:     0.10   irm_lambda:   100.00 val acc: 37.22 +- 0.85 test acc: 38.27 +- 0.86
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13018  0.11663  0.09915  0.08747  0.10308  0.09862  0.00000  0.33835  2.29882  -0.0002  0        0.96428  0.10111  0.11663  3.36277 
0.37675  0.36620  0.99557  0.99828  0.93864  0.92881  11.5486  0.06634  0.22458  0.00853  2000     0.98197  0.96711  0.36620  0.57595 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33872  2.28607  -0.0000  0        1.11005  0.09757  0.09777  3.36492 
0.38334  0.36878  0.99675  0.99571  0.93806  0.93224  11.5486  0.06797  0.23389  0.00831  2000     1.01040  0.96740  0.36878  0.59438 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.33390  2.27353  0.00034  0        0.98374  0.09976  0.09948  3.31297 
0.38036  0.36020  0.99494  0.99742  0.93612  0.93138  11.5486  0.06983  0.24227  0.00902  2000     1.01268  0.96553  0.36020  0.60584 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.36466  2.39954  0.01111  0        0.97965  0.10008  0.10463  3.51165 
0.37915  0.39365  0.99458  0.99399  0.93783  0.92795  11.5486  0.06628  0.23260  0.00794  2000     0.99898  0.96621  0.39365  0.58112 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.34430  2.34194  0.00275  0        1.25625  0.10360  0.10291  3.39213 
0.36115  0.35591  0.99427  0.99656  0.93553  0.92795  11.5486  0.07039  0.25029  0.00855  2000     0.96056  0.96490  0.35591  0.61598 
RRRRRRR ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 36.90 +- 1.31 test acc: 37.62 +- 0.78
Report with best val performance: val acc:68.77 +- 0.99  test acc:70.18 +- 0.91
Corresponding hypers: {'ib_lambda': 0.1, 'irm_lambda': 0.1}
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10194  0.07890  0.10425  0.09262  0.10141  0.10463  0.00000  346.714  2.29882  -0.0002  0        1.72749  0.10283  0.07890  3.36277 
0.09658  0.10806  0.09965  0.08662  0.09983  0.09691  11.5486  nan      nan      nan      2000     1.56871  0.09974  0.10806  nan     
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09820  0.10806  0.09532  0.08061  0.09942  0.09519  0.00000  345.991  2.28607  -0.0000  0        1.70186  0.09737  0.10806  3.36492 
0.10037  0.11149  0.09771  0.11663  0.09581  0.10463  11.5486  nan      nan      nan      2000     1.66076  0.09676  0.11149  nan     
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09576  0.09262  0.09730  0.11063  0.09888  0.09948  0.00000  340.326  2.27353  0.00034  0        1.59314  0.09809  0.09262  3.31297 
0.10028  0.10120  0.09861  0.09948  0.09608  0.11149  11.5486  nan      nan      nan      2000     1.50992  0.09735  0.10120  nan     
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  360.587  2.39954  0.01111  0        1.57248  0.10008  0.10463  3.51165 
0.09761  0.09605  0.09987  0.10634  0.09888  0.08319  11.5486  nan      nan      nan      2000     1.50952  0.09938  0.09605  nan     
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10050  0.10891  0.09897  0.09090  0.09825  0.10720  0.00000  348.563  2.34194  0.00275  0        1.59986  0.09861  0.10891  3.39213 
0.09991  0.09090  0.09739  0.10120  0.09920  0.09090  11.5486  nan      nan      nan      2000     1.50951  0.09829  0.09090  nan     
RRRRRRR mmd_lambda:   100.00 ib_lambda:   100.00   irm_lambda:     1.00 val acc: 10.69 +- 0.36 test acc: 10.06 +- 0.27
Report with best val performance: val acc:10.69 +- 0.36  test acc:10.06 +- 0.27
Corresponding hypers: {'mmd_lambda': 100, 'ib_lambda': 100, 'irm_lambda': 1}
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09676  0.09434  0.22195  0.22212  0.21180  0.20411  0.00000  33.7316  2.29882  -0.0002  0        1.87780  0.21687  0.09434  3.36277 
0.09658  0.10806  0.09965  0.08662  0.09983  0.09691  11.5486  nan      nan      nan      2000     1.66445  0.09974  0.10806  nan     
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10303  0.11578  0.49668  0.47598  0.45473  0.43996  0.00000  33.7439  2.28607  -0.0000  0        1.57929  0.47570  0.11578  3.36492 
0.10037  0.11149  0.09771  0.11663  0.09581  0.10463  11.5486  nan      nan      nan      2000     1.63565  0.09676  0.11149  nan     
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09495  0.09777  0.10885  0.12178  0.10696  0.11406  0.00000  33.2201  2.27353  0.00034  0        1.62253  0.10790  0.09777  3.31297 
0.10028  0.10120  0.09861  0.09948  0.09608  0.11149  11.5486  nan      nan      nan      2000     1.64454  0.09735  0.10120  nan     
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10240  0.10463  0.18396  0.19639  0.17945  0.18439  0.00000  35.2214  2.39954  0.01111  0        1.63933  0.18171  0.10463  3.51165 
0.09761  0.09605  0.09987  0.10634  0.09888  0.08319  11.5486  nan      nan      nan      2000     1.68616  0.09938  0.09605  nan     
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10009  0.10205  0.26458  0.24699  0.25321  0.23413  0.00000  34.0173  2.34194  0.00275  0        1.69009  0.25889  0.10205  3.39213 
0.09991  0.09090  0.09739  0.10120  0.09920  0.09090  11.5486  nan      nan      nan      2000     1.82277  0.09829  0.09090  nan     
RRRRRRR mmd_lambda:     1.00 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 10.63 +- 0.53 test acc: 10.05 +- 0.23
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09563  0.09691  0.21504  0.21612  0.20530  0.19982  0.00000  34.4641  2.29882  -0.0002  0        1.64230  0.21017  0.09691  3.36277 
0.09658  0.10806  0.09965  0.08662  0.09983  0.09691  11.5486  nan      nan      nan      2000     1.96017  0.09974  0.10806  nan     
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10348  0.11492  0.49691  0.47941  0.45621  0.44168  0.00000  34.3931  2.28607  -0.0000  0        1.88622  0.47656  0.11492  3.36492 
0.10037  0.11149  0.09771  0.11663  0.09581  0.10463  11.5486  nan      nan      nan      2000     1.94414  0.09676  0.11149  nan     
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09446  0.09777  0.10150  0.11835  0.10123  0.10291  0.00000  33.8281  2.27353  0.00034  0        2.04569  0.10136  0.09777  3.31297 
0.10028  0.10120  0.09861  0.09948  0.09608  0.11149  11.5486  nan      nan      nan      2000     3.19216  0.09735  0.10120  nan     
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10307  0.10891  0.18103  0.19554  0.17661  0.18010  0.00000  35.8524  2.39954  0.01111  0        1.86445  0.17882  0.10891  3.51165 
0.09761  0.09605  0.09987  0.10634  0.09888  0.08319  11.5486  nan      nan      nan      2000     1.82742  0.09938  0.09605  nan     
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09883  0.10120  0.26471  0.24785  0.25213  0.23413  0.00000  34.6477  2.34194  0.00275  0        1.88125  0.25842  0.10120  3.39213 
0.09991  0.09090  0.09739  0.10120  0.09920  0.09090  11.5486  nan      nan      nan      2000     1.81666  0.09829  0.09090  nan     
RRRRRRR mmd_lambda:    10.00 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 10.69 +- 0.52 test acc: 10.05 +- 0.26
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09662  0.10377  0.19592  0.19725  0.18753  0.19125  0.00000  41.7885  2.29882  -0.0002  0        1.87400  0.19172  0.10377  3.36277 
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09662  0.09434  0.22253  0.22212  0.21292  0.20154  0.00000  33.6502  2.29882  -0.0002  0        2.19022  0.21773  0.09434  3.36277 
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10375  0.09434  0.20259  0.18181  0.18911  0.18181  0.00000  33.6502  2.29882  -0.0002  0        0.95857  0.19585  0.09434  3.36277 
0.09658  0.10806  0.09965  0.08662  0.09983  0.09691  11.5486  nan      nan      nan      2000     0.89461  0.09974  0.10806  nan     
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10582  0.10463  0.19808  0.17753  0.19123  0.17152  0.00000  33.6718  2.28607  -0.0000  0        0.92272  0.19465  0.10463  3.36492 
0.10037  0.11149  0.09771  0.11663  0.09581  0.10463  11.5486  nan      nan      nan      2000     0.90905  0.09676  0.11149  nan     
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09576  0.09262  0.09730  0.11063  0.09888  0.09948  0.00000  33.1526  2.27353  0.00034  0        0.99197  0.09809  0.09262  3.31297 
0.10028  0.10120  0.09861  0.09948  0.09608  0.11149  11.5486  nan      nan      nan      2000     0.91183  0.09735  0.10120  nan     
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09640  0.10034  0.18491  0.19639  0.17932  0.18610  0.00000  35.1513  2.39954  0.01111  0        0.89789  0.18211  0.10034  3.51165 
0.09761  0.09605  0.09987  0.10634  0.09888  0.08319  11.5486  nan      nan      nan      2000     0.80248  0.09938  0.09605  nan     
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09924  0.10205  0.10411  0.08147  0.10673  0.09777  0.00000  33.9472  2.34194  0.00275  0        0.81097  0.10542  0.10205  3.39213 
0.09991  0.09090  0.09739  0.10120  0.09920  0.09090  11.5486  nan      nan      nan      2000     0.77923  0.09829  0.09090  nan     
RRRRRRR mmd_lambda:     0.00 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 10.46 +- 0.44 test acc: 9.86 +- 0.17
Report with best val performance: val acc:10.46 +- 0.44  test acc:9.86 +- 0.17
Corresponding hypers: {'mmd_lambda': 0, 'ib_lambda': 10, 'irm_lambda': 100}
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=1, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13884  0.11749  0.17318  0.16723  0.16939  0.15265  0.00000  3.32449  2.30551  0.00005  0        0.90289  0.17129  0.11749  3.32213 
0.87454  0.85334  0.99729  0.99914  0.99192  0.98627  11.5486  0.23420  0.11141  0.01919  2000     0.85029  0.99460  0.85334  0.21491 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33081  2.29966  -0.0000  0        0.79687  0.09757  0.09777  3.32854 
0.87220  0.86363  0.99693  0.99656  0.99111  0.98199  11.5486  0.24301  0.11510  0.02012  2000     0.85446  0.99402  0.86363  0.22278 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  3.30429  2.29149  0.00005  0        0.91933  0.09976  0.09948  3.30194 
0.87712  0.86878  0.99788  0.99485  0.99188  0.98456  11.5486  0.23723  0.11342  0.02003  2000     0.89564  0.99488  0.86878  0.21710 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39063  2.34405  0.00191  0        0.88880  0.10008  0.10463  3.38638 
0.85767  0.84991  0.99720  0.99914  0.99111  0.98627  11.5486  0.23657  0.11274  0.01927  2000     0.89812  0.99415  0.84991  0.21720 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  3.32462  2.30865  0.00018  0        0.88077  0.10360  0.10291  3.32213 
0.87215  0.85763  0.99747  0.99656  0.99305  0.98542  11.5486  0.23914  0.11471  0.02056  2000     0.85239  0.99526  0.85763  0.21849 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 85.87 +- 0.68 test acc: 87.07 +- 0.68
Report with best val performance: val acc:85.87 +- 0.68  test acc:87.07 +- 0.68
Corresponding hypers: {'mmd_lambda': 0, 'ib_lambda': 1, 'irm_lambda': 1000}
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=0, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12915  0.11406  0.09762  0.08576  0.10118  0.09605  0.00000  0.54185  2.30551  0.00005  0        0.98120  0.09940  0.09090  3.32213 
0.22428  0.21183  0.85487  0.84562  0.80065  0.77958  11.5486  0.20223  0.74401  0.01361  2000     0.90157  0.82776  0.81260  1.22217 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.54188  2.29966  -0.0000  0        0.87695  0.09757  0.09219  3.32854 
0.18594  0.18181  0.85482  0.83876  0.79090  0.77958  11.5486  0.20925  0.75181  0.01714  2000     0.86419  0.82286  0.80917  1.25316 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.53856  2.29149  0.00005  0        0.86908  0.09976  0.09648  3.30194 
0.21738  0.21269  0.82568  0.81989  0.76686  0.75900  11.5486  0.20125  0.73736  0.01390  2000     0.86592  0.79627  0.78945  1.21579 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.55347  2.34405  0.00191  0        0.87177  0.10008  0.10806  3.38638 
0.23069  0.23842  0.82104  0.82590  0.77037  0.77358  11.5486  0.20141  0.74535  0.01268  2000     0.86478  0.79571  0.79974  1.22118 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.54226  2.30865  0.00018  0        0.87033  0.10360  0.08790  3.32213 
0.20155  0.19039  0.86791  0.84991  0.80831  0.80360  11.5486  0.20220  0.73834  0.01461  2000     0.89952  0.83811  0.82675  1.21799 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     0.10   irm_lambda:    10.00 val acc: 80.75 +- 1.25 test acc: 21.20 +- 1.62
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12716  0.11063  0.08503  0.07718  0.09153  0.09090  0.00000  0.35509  2.30551  0.00005  0        0.87793  0.08828  0.08404  3.32213 
0.19239  0.18610  0.72395  0.72727  0.68015  0.66380  11.5486  0.18026  1.06359  0.00481  2000     0.90225  0.70205  0.69554  1.64962 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.35559  2.29966  -0.0000  0        0.98215  0.09757  0.09219  3.32854 
0.14584  0.13979  0.77177  0.77530  0.71403  0.69296  11.5486  0.19658  1.14472  0.00742  2000     0.91200  0.74290  0.73413  1.77899 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.35293  2.29149  0.00005  0        0.96604  0.09976  0.09648  3.30194 
0.19262  0.18267  0.70406  0.70240  0.66012  0.64494  11.5486  0.19046  1.11405  0.00698  2000     0.96493  0.68209  0.67367  1.72521 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.36373  2.34405  0.00191  0        0.92977  0.10008  0.10806  3.38638 
0.18495  0.18010  0.69747  0.71526  0.65245  0.66466  11.5486  0.18844  1.10457  0.00662  2000     0.96138  0.67496  0.68996  1.70952 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.35525  2.30865  0.00018  0        0.98756  0.10360  0.08790  3.32213 
0.18477  0.18524  0.70902  0.70240  0.66143  0.65180  11.5486  0.19408  1.13473  0.00734  2000     0.96227  0.68523  0.67710  1.75579 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     0.10   irm_lambda:   100.00 val acc: 69.41 +- 2.16 test acc: 18.01 +- 1.75
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12703  0.10977  0.08291  0.07461  0.08977  0.08747  0.00000  0.33457  2.30551  0.00005  0        0.87960  0.08634  0.08104  3.32213 
0.18729  0.18010  0.71782  0.72384  0.67374  0.66037  11.5486  0.17658  1.11153  0.00403  2000     0.87288  0.69578  0.69211  1.71441 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33511  2.29966  -0.0000  0        0.86215  0.09757  0.09219  3.32854 
0.13163  0.12778  0.77926  0.78044  0.71850  0.70068  11.5486  0.19359  1.20435  0.00653  2000     0.89250  0.74888  0.74056  1.85866 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.33254  2.29149  0.00005  0        0.86850  0.09976  0.09648  3.30194 
0.18603  0.17753  0.65917  0.66123  0.61844  0.59862  11.5486  0.18677  1.16690  0.00615  2000     0.87009  0.63881  0.62993  1.79465 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34288  2.34405  0.00191  0        0.87261  0.10008  0.10806  3.38638 
0.17949  0.16723  0.69765  0.71612  0.65178  0.66123  11.5486  0.18621  1.16303  0.00612  2000     0.88079  0.67471  0.68867  1.78937 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33470  2.30865  0.00018  0        1.00786  0.10360  0.08790  3.32213 
0.18021  0.18696  0.69702  0.69296  0.65137  0.64150  11.5486  0.18779  1.17384  0.00607  2000     0.86721  0.67420  0.66723  1.80549 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 68.37 +- 3.60 test acc: 17.29 +- 2.09
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12689  0.10977  0.08278  0.07461  0.08945  0.08747  0.00000  0.33250  2.30551  0.00005  0        0.85946  0.08611  0.08104  3.32213 
0.18648  0.18096  0.71732  0.72298  0.67293  0.65952  11.5486  0.17626  1.11694  0.00396  2000     0.86426  0.69513  0.69125  1.72183 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33305  2.29966  -0.0000  0        0.85817  0.09757  0.09219  3.32854 
0.13154  0.12950  0.77561  0.78301  0.71507  0.69125  11.5486  0.19292  1.20930  0.00633  2000     0.85942  0.74534  0.73713  1.86466 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.33048  2.29149  0.00005  0        0.86048  0.09976  0.09648  3.30194 
0.18540  0.17667  0.65746  0.65952  0.61681  0.59691  11.5486  0.18637  1.17238  0.00606  2000     0.90298  0.63714  0.62821  1.80198 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34078  2.34405  0.00191  0        0.88277  0.10008  0.10806  3.38638 
0.17931  0.16809  0.69765  0.71612  0.65150  0.66123  11.5486  0.18595  1.16961  0.00602  2000     0.90954  0.67458  0.68867  1.79811 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33263  2.30865  0.00018  0        0.88432  0.10360  0.08790  3.32213 
0.18071  0.18610  0.69874  0.69382  0.65299  0.64150  11.5486  0.18737  1.17931  0.00598  2000     0.85943  0.67587  0.66766  1.81281 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     0.10   irm_lambda: 10000.00 val acc: 68.26 +- 3.54 test acc: 17.27 +- 2.08
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13966  0.11921  0.18076  0.17152  0.17647  0.16380  0.00000  3.53177  2.30551  0.00005  0        0.88177  0.17862  0.16766  3.32213 
0.87170  0.85420  0.99783  0.99914  0.99201  0.98627  11.5486  0.23390  0.10495  0.02045  2000     0.86159  0.99492  0.99271  0.20576 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.53757  2.29966  -0.0000  0        0.80482  0.09757  0.09219  3.32854 
0.87459  0.86535  0.99751  0.99742  0.99066  0.98284  11.5486  0.24205  0.10801  0.02145  2000     0.80650  0.99409  0.99013  0.21273 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  3.51031  2.29149  0.00005  0        0.80589  0.09976  0.09648  3.30194 
0.87838  0.86706  0.99806  0.99571  0.99201  0.98370  11.5486  0.23486  0.10570  0.02128  2000     0.80657  0.99503  0.98970  0.20590 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.60121  2.34405  0.00191  0        0.81335  0.10008  0.10806  3.38638 
0.85961  0.85077  0.99747  0.99914  0.99088  0.98627  11.5486  0.23688  0.10633  0.02066  2000     0.80602  0.99418  0.99271  0.20842 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  3.53217  2.30865  0.00018  0        1.04294  0.10360  0.08790  3.32213 
0.87739  0.86792  0.99747  0.99656  0.99323  0.98456  11.5486  0.23565  0.10614  0.02210  2000     0.81045  0.99535  0.99056  0.20590 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     1.00   irm_lambda:    10.00 val acc: 99.12 +- 0.13 test acc: 87.23 +- 0.68
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13893  0.11749  0.17386  0.16809  0.17029  0.15351  0.00000  3.34501  2.30551  0.00005  0        0.80716  0.17208  0.16080  3.32213 
0.87572  0.85591  0.99765  0.99914  0.99183  0.98799  11.5486  0.23255  0.11014  0.01921  2000     0.80797  0.99474  0.99356  0.21243 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35128  2.29966  -0.0000  0        0.80679  0.09757  0.09219  3.32854 
0.87211  0.86964  0.99738  0.99656  0.98985  0.98456  11.5486  0.24341  0.11424  0.02025  2000     0.80860  0.99361  0.99056  0.22222 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  3.32468  2.29149  0.00005  0        0.81435  0.09976  0.09648  3.30194 
0.87206  0.86192  0.99765  0.99571  0.99133  0.98113  11.5486  0.23893  0.11339  0.02011  2000     0.80899  0.99449  0.98842  0.21790 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41148  2.34405  0.00191  0        0.80918  0.10008  0.10806  3.38638 
0.85785  0.85248  0.99706  0.99828  0.99124  0.98713  11.5486  0.23547  0.11191  0.01930  2000     0.80803  0.99415  0.99271  0.21525 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  3.34517  2.30865  0.00018  0        0.81087  0.10360  0.08790  3.32213 
0.86845  0.85763  0.99760  0.99656  0.99318  0.98542  11.5486  0.23967  0.11420  0.02083  2000     0.80810  0.99539  0.99099  0.21791 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.13 +- 0.18 test acc: 86.92 +- 0.61
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13884  0.11749  0.17318  0.16723  0.16939  0.15265  0.00000  3.32449  2.30551  0.00005  0        0.81805  0.17129  0.15994  3.32213 
0.87454  0.85334  0.99729  0.99914  0.99192  0.98627  11.5486  0.23420  0.11141  0.01919  2000     0.81041  0.99460  0.99271  0.21491 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33081  2.29966  -0.0000  0        0.81108  0.09757  0.09219  3.32854 
0.87220  0.86363  0.99693  0.99656  0.99111  0.98199  11.5486  0.24301  0.11510  0.02012  2000     0.80771  0.99402  0.98928  0.22278 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  3.30429  2.29149  0.00005  0        0.80901  0.09976  0.09648  3.30194 
0.87712  0.86878  0.99788  0.99485  0.99188  0.98456  11.5486  0.23723  0.11342  0.02003  2000     0.81552  0.99488  0.98970  0.21710 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39063  2.34405  0.00191  0        0.88510  0.10008  0.10806  3.38638 
0.85767  0.84991  0.99720  0.99914  0.99111  0.98627  11.5486  0.23657  0.11274  0.01927  2000     0.81088  0.99415  0.99271  0.21720 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  3.32462  2.30865  0.00018  0        0.80769  0.10360  0.08790  3.32213 
0.87215  0.85763  0.99747  0.99656  0.99305  0.98542  11.5486  0.23914  0.11471  0.02056  2000     0.80909  0.99526  0.99099  0.21849 
RRRRRRR mmd_lambda:     0.00 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 99.11 +- 0.14 test acc: 87.07 +- 0.68
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13871  0.11749  0.17305  0.16723  0.16935  0.15265  0.00000  3.32242  2.30551  0.00005  0        0.80831  0.17120  0.15994  3.32213 
0.87346  0.85420  0.99769  0.99914  0.99169  0.98456  11.5486  0.23416  0.11155  0.01910  2000     0.80860  0.99469  0.99185  0.21505 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.32874  2.29966  -0.0000  0        0.81021  0.09757  0.09219  3.32854 
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=0, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=0, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.53185  2.30551  0.00005  0        1.94421  0.11241  0.10548  3.32213 
0.87689  0.85334  0.99742  0.99914  0.99242  0.98542  11.5486  0.23189  0.10428  0.02033  2000     1.78511  0.99492  0.99228  0.20386 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.53765  2.29966  -0.0000  0        1.80750  0.09757  0.09219  3.32854 
0.87409  0.85763  0.99715  0.99742  0.99088  0.98284  11.5486  0.24116  0.10770  0.02134  2000     1.70975  0.99402  0.99013  0.21189 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10307  0.10634  0.10019  0.10120  0.09960  0.09176  0.00000  3.51038  2.29149  0.00005  0        1.67117  0.09990  0.09648  3.30194 
0.87860  0.87049  0.99819  0.99485  0.99183  0.98284  11.5486  0.23601  0.10613  0.02133  2000     1.65623  0.99501  0.98885  0.20689 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.60128  2.34405  0.00191  0        1.66439  0.10008  0.10806  3.38638 
0.85528  0.84819  0.99760  0.99828  0.99102  0.98456  11.5486  0.23656  0.10611  0.02073  2000     1.65461  0.99431  0.99142  0.20800 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11218  0.11235  0.16479  0.14837  0.16114  0.14494  0.00000  3.53224  2.30865  0.00018  0        1.66522  0.16296  0.14665  3.32213 
0.87522  0.85849  0.99751  0.99571  0.99336  0.98627  11.5486  0.23440  0.10570  0.02204  2000     1.68574  0.99544  0.99099  0.20469 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     1.00   irm_lambda:    10.00 val acc: 99.07 +- 0.12 test acc: 87.20 +- 0.85
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.34509  2.30551  0.00005  0        1.79363  0.11241  0.10548  3.32213 
0.87657  0.85763  0.99756  0.99914  0.99237  0.98627  11.5486  0.23202  0.10982  0.01919  2000     1.78335  0.99497  0.99271  0.21186 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35135  2.29966  -0.0000  0        1.78718  0.09757  0.09219  3.32854 
0.87229  0.86106  0.99729  0.99742  0.98989  0.98456  11.5486  0.24483  0.11486  0.02035  2000     1.72789  0.99359  0.99099  0.22347 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10366  0.10891  0.10019  0.10120  0.09969  0.09176  0.00000  3.32475  2.29149  0.00005  0        1.66114  0.09994  0.09648  3.30194 
0.87703  0.87135  0.99774  0.99485  0.99111  0.98370  11.5486  0.23752  0.11280  0.02009  2000     1.76432  0.99442  0.98928  0.21643 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41155  2.34405  0.00191  0        1.77690  0.10008  0.10806  3.38638 
0.85569  0.84991  0.99769  0.99914  0.99052  0.98627  11.5486  0.23624  0.11211  0.01933  2000     1.81031  0.99411  0.99271  0.21592 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11169  0.11235  0.15297  0.13293  0.14954  0.12693  0.00000  3.34524  2.30865  0.00018  0        1.79798  0.15126  0.12993  3.32213 
0.87315  0.85591  0.99738  0.99485  0.99336  0.98627  11.5486  0.23935  0.11409  0.02077  2000     1.78850  0.99537  0.99056  0.21759 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.13 +- 0.13 test acc: 87.09 +- 0.78
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32457  2.30551  0.00005  0        1.79321  0.11241  0.10548  3.32213 
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=0, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.53991  2.30551  0.00005  0        1.86281  0.11241  0.10548  3.32213 
0.88203  0.85934  0.99765  0.99914  0.99273  0.98970  11.5486  0.23379  0.10242  0.02008  2000     1.68436  0.99519  0.99442  0.19944 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.54479  2.29966  -0.0000  0        1.75713  0.09757  0.09219  3.32854 
0.87581  0.87049  0.99756  0.99656  0.99093  0.98370  11.5486  0.24390  0.10617  0.02121  2000     1.78048  0.99424  0.99013  0.20807 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10316  0.10806  0.10019  0.10120  0.09969  0.09176  0.00000  3.51706  2.29149  0.00005  0        1.76879  0.09994  0.09648  3.30194 
0.87856  0.86449  0.99810  0.99485  0.99156  0.98370  11.5486  0.24198  0.10592  0.02134  2000     1.76856  0.99483  0.98928  0.20614 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.60822  2.34405  0.00191  0        1.78760  0.10008  0.10806  3.38638 
0.85957  0.85420  0.99792  0.99828  0.99151  0.98542  11.5486  0.23948  0.10473  0.02058  2000     1.88380  0.99472  0.99185  0.20444 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11218  0.11235  0.16479  0.14837  0.16114  0.14494  0.00000  3.53918  2.30865  0.00018  0        1.87847  0.16296  0.14665  3.32213 
0.87856  0.86535  0.99751  0.99571  0.99345  0.98627  11.5486  0.24006  0.10515  0.02210  2000     1.85896  0.99548  0.99099  0.20360 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     1.00   irm_lambda:    10.00 val acc: 99.13 +- 0.18 test acc: 87.49 +- 0.79
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.35315  2.30551  0.00005  0        1.84598  0.11241  0.10548  3.32213 
0.87969  0.86106  0.99769  0.99914  0.99210  0.98970  11.5486  0.23542  0.10865  0.01912  2000     1.73473  0.99490  0.99442  0.20869 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35849  2.29966  -0.0000  0        1.64496  0.09757  0.09219  3.32854 
0.87666  0.86706  0.99706  0.99656  0.99048  0.98456  11.5486  0.24758  0.11348  0.02021  2000     1.64268  0.99377  0.99056  0.21956 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10343  0.10891  0.10019  0.10120  0.09960  0.09176  0.00000  3.33144  2.29149  0.00005  0        1.64536  0.09990  0.09648  3.30194 
0.87784  0.87307  0.99760  0.99485  0.99133  0.98456  11.5486  0.24361  0.11272  0.02013  2000     1.64312  0.99447  0.98970  0.21575 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41849  2.34405  0.00191  0        1.66225  0.10008  0.10806  3.38638 
0.86011  0.85591  0.99760  0.99828  0.99142  0.98627  11.5486  0.23867  0.11059  0.01923  2000     1.64301  0.99451  0.99228  0.21173 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11173  0.11235  0.15297  0.13293  0.14954  0.12693  0.00000  3.35218  2.30865  0.00018  0        1.64638  0.15126  0.12993  3.32213 
0.87423  0.85934  0.99729  0.99571  0.99363  0.98627  11.5486  0.24278  0.11288  0.02060  2000     1.64290  0.99546  0.99099  0.21443 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.16 +- 0.16 test acc: 87.37 +- 0.70
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.33263  2.30551  0.00005  0        1.65806  0.11241  0.10548  3.32213 
0.88045  0.85934  0.99760  0.99914  0.99206  0.98713  11.5486  0.23804  0.11027  0.01909  2000     1.64732  0.99483  0.99313  0.21208 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33802  2.29966  -0.0000  0        1.64620  0.09757  0.09219  3.32854 
0.87779  0.87049  0.99706  0.99742  0.99102  0.98199  11.5486  0.24272  0.11241  0.01990  2000     1.64846  0.99404  0.98970  0.21585 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10334  0.10977  0.10019  0.10120  0.09956  0.09176  0.00000  3.31104  2.29149  0.00005  0        1.66632  0.09987  0.09648  3.30194 
0.88154  0.86878  0.99788  0.99571  0.99174  0.98542  11.5486  0.24125  0.11240  0.01996  2000     1.64665  0.99481  0.99056  0.21439 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39764  2.34405  0.00191  0        1.64732  0.10008  0.10806  3.38638 
0.86020  0.85506  0.99724  0.99914  0.99188  0.98542  11.5486  0.23790  0.11083  0.01905  2000     1.67882  0.99456  0.99228  0.21197 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11110  0.11235  0.15072  0.13207  0.14814  0.12521  0.00000  3.33163  2.30865  0.00018  0        1.84567  0.14943  0.12864  3.32213 
0.87770  0.86192  0.99747  0.99571  0.99377  0.98799  11.5486  0.24175  0.11311  0.02045  2000     1.84464  0.99562  0.99185  0.21441 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 99.15 +- 0.12 test acc: 87.55 +- 0.78
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.33055  2.30551  0.00005  0        1.87125  0.11241  0.10548  3.32213 
0.87373  0.85677  0.99756  0.99914  0.99192  0.98885  11.5486  0.23864  0.11052  0.01912  2000     1.87635  0.99474  0.99399  0.21275 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33595  2.29966  -0.0000  0        1.89779  0.09757  0.09219  3.32854 
0.87540  0.87221  0.99738  0.99742  0.99043  0.98542  11.5486  0.24703  0.11400  0.01998  2000     1.87676  0.99391  0.99142  0.22011 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10334  0.10977  0.10019  0.10120  0.09956  0.09176  0.00000  3.30898  2.29149  0.00005  0        1.87973  0.09987  0.09648  3.30194 
0.88149  0.87221  0.99769  0.99571  0.99160  0.98542  11.5486  0.24066  0.11204  0.01982  2000     1.80019  0.99465  0.99056  0.21401 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39554  2.34405  0.00191  0        1.75685  0.10008  0.10806  3.38638 
0.86101  0.85591  0.99751  0.99914  0.99129  0.98456  11.5486  0.23899  0.11131  0.01909  2000     1.76415  0.99440  0.99185  0.21310 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11097  0.11235  0.15067  0.13207  0.14810  0.12435  0.00000  3.32955  2.30865  0.00018  0        1.76098  0.14938  0.12821  3.32213 
0.87928  0.86620  0.99747  0.99656  0.99382  0.98713  11.5486  0.24092  0.11296  0.02041  2000     1.76324  0.99564  0.99185  0.21371 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     1.00   irm_lambda: 10000.00 val acc: 99.19 +- 0.11 test acc: 87.42 +- 0.71
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  4.34560  2.30551  0.00005  0        1.76740  0.11241  0.10548  3.32213 
0.90075  0.88850  0.99639  0.99828  0.99269  0.99228  11.5486  0.69938  0.10969  0.02235  2000     1.76021  0.99454  0.99528  0.19701 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  4.25888  2.29966  -0.0000  0        1.75697  0.09757  0.09219  3.32854 
0.90026  0.89451  0.99557  0.99313  0.99309  0.99142  11.5486  0.69670  0.10732  0.02342  2000     1.68162  0.99433  0.99228  0.19237 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09991  0.10034  0.10019  0.10120  0.09933  0.09176  0.00000  4.18582  2.29149  0.00005  0        1.64888  0.09976  0.09648  3.30194 
0.90590  0.89279  0.99535  0.99399  0.99228  0.98627  11.5486  0.71341  0.11199  0.02411  2000     1.73518  0.99382  0.99013  0.19858 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  4.30234  2.34405  0.00191  0        1.93474  0.10008  0.10806  3.38638 
0.89963  0.89794  0.99639  0.99914  0.99291  0.98970  11.5486  0.70250  0.10857  0.02255  2000     1.91768  0.99465  0.99442  0.19422 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11241  0.11063  0.16596  0.15008  0.16208  0.14665  0.00000  4.23265  2.30865  0.00018  0        1.88583  0.16402  0.14837  3.32213 
0.90504  0.89879  0.99616  0.99656  0.99449  0.98885  11.5486  0.69392  0.10920  0.02427  2000     1.86545  0.99533  0.99271  0.19206 
RRRRRRR mmd_lambda: 10000.00 ib_lambda:     1.00   irm_lambda:    10.00 val acc: 99.30 +- 0.18 test acc: 90.23 +- 0.26
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  4.15883  2.30551  0.00005  0        1.88073  0.11241  0.10548  3.32213 
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='FullColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=0, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12829  0.11235  0.09500  0.08833  0.10172  0.10034  0.00000  0.21499  2.29882  -0.0002  0        1.07704  0.09836  0.09434  0.06209 
0.24936  0.23241  0.97518  0.97770  0.90693  0.90308  11.5486  0.05210  0.34127  0.01161  2000     1.00509  0.94106  0.94039  0.10516 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.21402  2.28607  -0.0000  0        0.99998  0.09757  0.09219  0.06241 
0.23515  0.21355  0.98330  0.98799  0.90864  0.89879  11.5486  0.05399  0.34307  0.01329  2000     1.04556  0.94597  0.94339  0.10717 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.21242  2.27353  0.00034  0        1.11445  0.09976  0.09648  0.05428 
0.25166  0.23327  0.99688  0.99828  0.92321  0.91852  11.5486  0.04834  0.30225  0.01128  2000     0.96771  0.96005  0.95840  0.10610 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.23352  2.39954  0.01111  0        0.92881  0.10008  0.10806  0.05281 
0.25753  0.26243  0.98714  0.98885  0.91884  0.90480  11.5486  0.05131  0.34245  0.01070  2000     0.92779  0.95299  0.94682  0.10446 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.22030  2.34194  0.00275  0        0.94056  0.10360  0.08790  0.04895 
0.25320  0.25471  0.97979  0.98370  0.91040  0.90994  11.5486  0.05141  0.34105  0.01090  2000     0.92982  0.94509  0.94682  0.10494 
RRRRRRR  ib_lambda:     0.10   irm_lambda:    10.00 val acc: 94.72 +- 0.61 test acc: 24.94 +- 0.76
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12315  0.10977  0.06545  0.05746  0.07249  0.07118  0.00000  0.02875  2.29882  -0.0002  0        0.94597  0.06897  0.06432  0.06209 
0.14484  0.13979  0.21121  0.21698  0.21094  0.18524  11.5486  0.02309  2.29365  0.00004  2000     0.92904  0.21108  0.20111  0.00336 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.02882  2.28607  -0.0000  0        0.94273  0.09757  0.09219  0.06241 
0.11245  0.12435  0.23291  0.23156  0.21762  0.21097  11.5486  0.02306  2.28814  -0.0000  2000     0.92974  0.22526  0.22126  0.00413 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.02827  2.27353  0.00034  0        0.92534  0.09976  0.09648  0.05428 
0.15612  0.16209  0.28213  0.27615  0.26792  0.25557  11.5486  0.02304  2.28715  0.00002  2000     0.92956  0.27502  0.26586  0.00378 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.04004  2.39954  0.01111  0        0.92606  0.10008  0.10806  0.05281 
0.10515  0.10291  0.18816  0.18696  0.18017  0.20497  11.5486  0.02307  2.28907  0.00003  2000     0.92969  0.18417  0.19596  0.00378 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.03080  2.34194  0.00275  0        0.92599  0.10360  0.08790  0.04895 
0.10014  0.10548  0.10222  0.08147  0.10565  0.09862  11.5486  0.02305  2.29174  0.00004  2000     0.92830  0.10393  0.09005  0.00315 
RRRRRRR  ib_lambda:     0.10   irm_lambda:   100.00 val acc: 19.49 +- 5.79 test acc: 12.37 +- 2.25
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12251  0.11063  0.06225  0.05746  0.06956  0.06775  0.00000  0.00828  2.29882  -0.0002  0        0.93597  0.06590  0.06260  0.06209 
0.13086  0.12950  0.20774  0.21355  0.20756  0.17838  11.5486  0.00264  2.30046  0.00002  2000     0.93007  0.20765  0.19596  0.00320 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.00847  2.28607  -0.0000  0        0.93550  0.09757  0.09219  0.06241 
0.12193  0.13636  0.23638  0.22813  0.22145  0.21440  11.5486  0.00265  2.29864  0.00000  2000     0.92765  0.22892  0.22126  0.00356 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.00803  2.27353  0.00034  0        0.94080  0.09976  0.09648  0.05428 
0.13289  0.13036  0.28795  0.27701  0.27085  0.26243  11.5486  0.00265  2.29707  0.00000  2000     0.93039  0.27940  0.26972  0.00352 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.01877  2.39954  0.01111  0        0.92795  0.10008  0.10806  0.05281 
0.10009  0.10034  0.16177  0.16552  0.15753  0.17838  11.5486  0.00267  2.29931  0.00003  2000     0.92940  0.15965  0.17195  0.00345 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.00998  2.34194  0.00275  0        0.87192  0.10360  0.08790  0.04895 
0.09026  0.09090  0.12072  0.10034  0.12144  0.12006  11.5486  0.00261  2.30013  0.00001  2000     0.93375  0.12108  0.11020  0.00300 
RRRRRRR  ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 19.38 +- 5.29 test acc: 11.52 +- 1.71
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12242  0.11063  0.06216  0.05746  0.06938  0.06775  0.00000  0.00622  2.29882  -0.0002  0        0.93336  0.06577  0.06260  0.06209 
0.12874  0.12521  0.20733  0.21269  0.20566  0.17838  11.5486  0.00057  2.30101  0.00002  2000     0.92960  0.20650  0.19554  0.00320 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.00641  2.28607  -0.0000  0        0.94163  0.09757  0.09219  0.06241 
0.12468  0.14065  0.25344  0.24185  0.23823  0.23327  11.5486  0.00058  2.29938  0.00000  2000     0.92928  0.24583  0.23756  0.00356 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.00599  2.27353  0.00034  0        1.03250  0.09976  0.09648  0.05428 
0.12878  0.13293  0.29034  0.27787  0.27297  0.26758  11.5486  0.00059  2.29791  0.00001  2000     0.93039  0.28165  0.27272  0.00348 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.01663  2.39954  0.01111  0        0.94402  0.10008  0.10806  0.05281 
0.10082  0.09862  0.16975  0.16981  0.16362  0.18353  11.5486  0.00060  2.29996  0.00003  2000     0.90583  0.16668  0.17667  0.00343 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.00788  2.34194  0.00275  0        0.87058  0.10360  0.08790  0.04895 
0.08607  0.08404  0.13249  0.11835  0.13199  0.13036  11.5486  0.00054  2.30072  0.00001  2000     0.89193  0.13224  0.12435  0.00300 
RRRRRRR  ib_lambda:     0.10   irm_lambda: 10000.00 val acc: 20.14 +- 5.09 test acc: 11.38 +- 1.73
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13275  0.12264  0.11178  0.10463  0.11467  0.10463  0.00000  0.27087  2.29882  -0.0002  0        0.94262  0.11323  0.10463  0.06209 
0.14232  0.14322  0.75666  0.76586  0.70600  0.67495  11.5486  0.12297  1.01087  0.00664  2000     0.85402  0.73133  0.72041  0.02503 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.27019  2.28607  -0.0000  0        0.81561  0.09757  0.09219  0.06241 
0.12414  0.12264  0.78991  0.79588  0.72147  0.70497  11.5486  0.11497  0.90801  0.00688  2000     0.83270  0.75569  0.75042  0.02617 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.26127  2.27353  0.00034  0        0.86267  0.09976  0.09648  0.05428 
0.16302  0.15008  0.80128  0.79416  0.74110  0.72641  11.5486  0.11766  0.96034  0.00598  2000     0.92646  0.77119  0.76029  0.02492 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.28105  2.39954  0.01111  0        0.94338  0.10008  0.10806  0.05281 
0.16190  0.17066  0.79898  0.80446  0.73925  0.75042  11.5486  0.11168  0.88812  0.00599  2000     0.94765  0.76911  0.77744  0.02550 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.26436  2.34194  0.00275  0        0.93409  0.10360  0.08790  0.04895 
0.17259  0.17066  0.80809  0.77358  0.74872  0.74013  11.5486  0.11388  0.90243  0.00622  2000     0.93177  0.77840  0.75686  0.02618 
RRRRRRR  ib_lambda:     1.00   irm_lambda:    10.00 val acc: 75.31 +- 1.86 test acc: 15.28 +- 1.74
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13226  0.11921  0.09996  0.08919  0.10249  0.09691  0.00000  0.08463  2.29882  -0.0002  0        0.90042  0.10123  0.09305  0.06209 
0.10664  0.09862  0.14205  0.14837  0.13917  0.12435  11.5486  0.02377  2.29534  0.00003  2000     0.92046  0.14061  0.13636  0.00102 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.08499  2.28607  -0.0000  0        0.82288  0.09757  0.09219  0.06241 
0.09775  0.09777  0.09829  0.09176  0.09775  0.09262  11.5486  0.02379  2.29429  0.00002  2000     0.84442  0.09802  0.09219  0.00105 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.07713  2.27353  0.00034  0        0.84460  0.09976  0.09648  0.05428 
0.11385  0.11149  0.29931  0.29245  0.27937  0.26329  11.5486  0.02371  2.29153  0.00003  2000     0.83836  0.28934  0.27787  0.00099 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.08757  2.39954  0.01111  0        0.82512  0.10008  0.10806  0.05281 
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  11.5486  0.02382  2.29343  0.00004  2000     0.85653  0.10008  0.10806  0.00107 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.07486  2.34194  0.00275  0        0.89928  0.10360  0.08790  0.04895 
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  11.5486  0.02372  2.29451  0.00003  2000     0.86327  0.10360  0.08790  0.00097 
RRRRRRR  ib_lambda:     1.00   irm_lambda:   100.00 val acc: 14.05 +- 7.08 test acc: 10.47 +- 0.56
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13190  0.11921  0.09753  0.08833  0.10064  0.09519  0.00000  0.06416  2.29882  -0.0002  0        0.89170  0.09908  0.09176  0.06209 
0.07939  0.08147  0.13628  0.12607  0.13014  0.12778  11.5486  0.00332  2.30128  0.00000  2000     0.86796  0.13321  0.12693  0.00101 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.06464  2.28607  -0.0000  0        0.83166  0.09757  0.09219  0.06241 
0.09536  0.09691  0.10511  0.10291  0.10434  0.10291  11.5486  0.00334  2.30086  0.00000  2000     0.87205  0.10472  0.10291  0.00104 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10041  0.09948  0.10019  0.10120  0.09933  0.09176  0.00000  0.05689  2.27353  0.00034  0        0.93461  0.09976  0.09648  0.05428 
0.09549  0.09176  0.14868  0.15437  0.14386  0.14837  11.5486  0.00329  2.29991  0.00001  2000     0.88156  0.14627  0.15137  0.00098 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.06630  2.39954  0.01111  0        0.86024  0.10008  0.10806  0.05281 
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='ColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=0, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'ColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
Args: Namespace(algorithm='IBIRM', bs=128, checkpoint_freq=2000, class_condition=False, d=0, data_dir='~/data/', dataset='ColoredMNIST', debug=False, dro_eta=None, env_seed=1, holdout_fraction=0.05, hparams=None, hparams_seed=0, ib_lambda=None, ib_step=0, irm_lambda=None, irm_step=0, lr=0.1, mmd_lambda=None, mmd_step=0, n_restarts=5, no_aug=False, normalize=False, output_dir='train_output', ratio=0.9, sch_size=-1, seed=0, skip_model_save=False, steps=2001, test_envs=[0], test_val=0, trial_seed=0, type=0, vrex_lambda=None, vrex_step=0, wd=0, xyl=1)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'ColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
Args: Namespace(data_dir='~/data/', dataset='FullColoredMNIST', algorithm='IBIRM', hparams=None, hparams_seed=0, trial_seed=0, seed=0, steps=2001, checkpoint_freq=2000, test_envs=[0], output_dir='train_output', holdout_fraction=0.05, skip_model_save=False, lr=0.1, irm_lambda=None, irm_step=0, vrex_lambda=None, vrex_step=0, ib_lambda=None, ib_step=0, mmd_lambda=None, mmd_step=0, class_condition=False, normalize=False, dro_eta=None, bs=128, wd=0, sch_size=-1, d=0, debug=False, type=0, ratio=0.9, env_seed=1, no_aug=False, xyl=1, n_restarts=5, test_val=0)
Hparams: {'data_augmentation': True, 'resnet18': False, 'lr': 0.1, 'batch_size': 128, 'weight_decay': 0, 'class_balanced': False, 'resnet_dropout': 0.0, 'irm_lambda': 100.0, 'irm_penalty_anneal_iters': 0, 'vrex_lambda': 10.0, 'vrex_penalty_anneal_iters': 500, 'ib_lambda': 1, 'ib_penalty_anneal_iters': 0, 'mmd_lambda': 10.0, 'mmd_penalty_anneal_iters': 0, 'mixup_alpha': 0.2, 'groupdro_eta': 0.01, 'mmd_gamma': 1.0, 'mlp_width': 256, 'mlp_depth': 3, 'mlp_dropout': 0.0, 'mldg_beta': 1.0, 'mtl_ema': 0.99, 'sag_w_adv': 0.1, 'class_condition': False, 'normalize': False, 'xylopt': 1, 'xylnn': 1, 'dataset': 'FullColoredMNIST', 'sch_size': 600}
RRRRRRR Hyper sweep for IB-IRM
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12112  0.10806  0.11160  0.10891  0.11417  0.10377  0.00000  0.35509  2.30551  0.00005  0        1.62711  0.11289  0.10634  3.32213 
0.19153  0.18439  0.72224  0.72641  0.67871  0.66295  11.5486  0.18030  1.06370  0.00481  2000     0.01640  0.70047  0.69468  1.65005 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.35559  2.29965  -0.0000  0        0.02261  0.09757  0.09219  3.32854 
0.14394  0.13722  0.76451  0.76415  0.70830  0.69039  11.5486  0.19664  1.14486  0.00746  2000     0.01597  0.73641  0.72727  1.77923 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10377  0.10019  0.10120  0.09974  0.09005  0.00000  0.35293  2.29149  0.00005  0        0.02349  0.09996  0.09562  3.30193 
0.19203  0.18353  0.70325  0.70411  0.65976  0.64150  11.5486  0.19034  1.11361  0.00692  2000     0.01574  0.68150  0.67281  1.72464 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.36374  2.34406  0.00191  0        0.02507  0.10008  0.10806  3.38638 
0.18499  0.18010  0.69743  0.71526  0.65250  0.66466  11.5486  0.18837  1.10384  0.00664  2000     0.01733  0.67496  0.68996  1.70868 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.35525  2.30866  0.00018  0        0.02418  0.10360  0.08790  3.32214 
0.18319  0.18267  0.70862  0.70240  0.66161  0.65265  11.5486  0.19410  1.13507  0.00732  2000     0.01641  0.68511  0.67753  1.75611 
RRRRRRR mmd_lambda:     0.10 ib_lambda:     0.10   irm_lambda:   100.00 val acc: 69.25 +- 1.91 test acc: 17.91 +- 1.79
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33457  2.30551  0.00005  0        0.02475  0.11289  0.10634  3.32213 
0.18603  0.18010  0.71737  0.72298  0.67338  0.66123  11.5486  0.17666  1.11143  0.00410  2000     0.01641  0.69538  0.69211  1.71459 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33511  2.29965  -0.0000  0        0.02447  0.09757  0.09219  3.32854 
0.13221  0.13036  0.77624  0.78130  0.71538  0.69039  11.5486  0.19354  1.20348  0.00657  2000     0.01641  0.74581  0.73584  1.85775 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33254  2.29149  0.00005  0        0.02480  0.09996  0.09562  3.30193 
0.18522  0.17838  0.65949  0.66209  0.61938  0.59948  11.5486  0.18673  1.16662  0.00614  2000     0.01619  0.63944  0.63078  1.79437 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34289  2.34406  0.00191  0        0.02349  0.10008  0.10806  3.38638 
0.17994  0.16638  0.69765  0.71612  0.65191  0.66209  11.5486  0.18620  1.16339  0.00607  2000     0.01601  0.67478  0.68910  1.78965 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33470  2.30866  0.00018  0        0.02336  0.10360  0.08790  3.32214 
0.18017  0.18782  0.69770  0.69211  0.65259  0.64065  11.5486  0.18775  1.17379  0.00606  2000     0.01630  0.67514  0.66638  1.80528 
RRRRRRR mmd_lambda:     0.10 ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 68.28 +- 3.44 test acc: 17.27 +- 2.04
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33250  2.30551  0.00005  0        0.02277  0.11289  0.10634  3.32213 
0.18648  0.18010  0.71683  0.72041  0.67271  0.65866  11.5486  0.17628  1.11658  0.00402  2000     0.01522  0.69477  0.68953  1.72150 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33305  2.29965  -0.0000  0        0.02225  0.09757  0.09219  3.32854 
0.13068  0.12778  0.77994  0.78473  0.71976  0.69725  11.5486  0.19314  1.20960  0.00643  2000     0.01527  0.74985  0.74099  1.86583 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33048  2.29149  0.00005  0        0.02378  0.09996  0.09562  3.30193 
0.18445  0.17324  0.65430  0.65437  0.61397  0.59434  11.5486  0.18636  1.17235  0.00605  2000     0.01641  0.63414  0.62435  1.80189 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34078  2.34406  0.00191  0        0.02341  0.10008  0.10806  3.38638 
0.17913  0.16552  0.69765  0.71612  0.65159  0.66037  11.5486  0.18593  1.16931  0.00604  2000     0.01531  0.67462  0.68825  1.79779 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33263  2.30866  0.00018  0        0.02240  0.10360  0.08790  3.32214 
0.18075  0.18867  0.69792  0.69211  0.65250  0.64150  11.5486  0.18752  1.18021  0.00598  2000     0.01515  0.67521  0.66681  1.81418 
RRRRRRR mmd_lambda:     0.10 ib_lambda:     0.10   irm_lambda: 10000.00 val acc: 68.20 +- 3.78 test acc: 17.23 +- 2.10
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.34501  2.30551  0.00005  0        0.02216  0.11241  0.10548  3.32213 
0.87495  0.85591  0.99769  0.99914  0.99174  0.98627  11.5486  0.23315  0.11030  0.01920  2000     0.01526  0.99472  0.99271  0.21304 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35127  2.29965  -0.0000  0        0.02340  0.09757  0.09219  3.32854 
0.87161  0.86020  0.99742  0.99656  0.98998  0.98199  11.5486  0.24544  0.11512  0.02037  2000     0.01639  0.99370  0.98928  0.22413 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10891  0.10019  0.10120  0.09965  0.09176  0.00000  3.32468  2.29149  0.00005  0        0.02596  0.09992  0.09648  3.30193 
0.87775  0.86620  0.99760  0.99571  0.99147  0.98284  11.5486  0.23681  0.11241  0.02007  2000     0.01744  0.99454  0.98928  0.21582 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41148  2.34406  0.00191  0        0.02446  0.10008  0.10806  3.38638 
0.85474  0.85077  0.99756  0.99914  0.99043  0.98370  11.5486  0.23775  0.11275  0.01952  2000     0.01643  0.99400  0.99142  0.21730 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11155  0.11235  0.15279  0.13293  0.14936  0.12693  0.00000  3.34518  2.30866  0.00018  0        0.02471  0.15108  0.12993  3.32214 
0.87400  0.85334  0.99751  0.99656  0.99314  0.98627  11.5486  0.23753  0.11322  0.02072  2000     0.01518  0.99533  0.99142  0.21588 
RRRRRRR mmd_lambda:     0.10 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.08 +- 0.13 test acc: 87.06 +- 0.82
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32449  2.30551  0.00005  0        0.02219  0.11241  0.10548  3.32213 
0.87423  0.85420  0.99760  0.99914  0.99201  0.98713  11.5486  0.23259  0.11075  0.01908  2000     0.01541  0.99481  0.99313  0.21341 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33080  2.29965  -0.0000  0        0.02329  0.09757  0.09219  3.32854 
0.87288  0.85849  0.99729  0.99742  0.99030  0.98370  11.5486  0.24384  0.11540  0.02017  2000     0.01618  0.99379  0.99056  0.22356 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10891  0.10019  0.10120  0.09956  0.09176  0.00000  3.30428  2.29149  0.00005  0        0.02426  0.09987  0.09648  3.30193 
0.87874  0.87307  0.99756  0.99399  0.99147  0.98456  11.5486  0.23692  0.11335  0.01992  2000     0.01632  0.99451  0.98928  0.21690 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39063  2.34406  0.00191  0        0.02330  0.10008  0.10806  3.38638 
0.86227  0.85420  0.99747  0.99914  0.99183  0.98627  11.5486  0.23375  0.11173  0.01914  2000     0.01642  0.99465  0.99271  0.21451 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11106  0.11235  0.15103  0.13207  0.14823  0.12521  0.00000  3.32463  2.30866  0.00018  0        0.02374  0.14963  0.12864  3.32214 
0.87288  0.85506  0.99733  0.99656  0.99287  0.98542  11.5486  0.23836  0.11449  0.02054  2000     0.01572  0.99510  0.99099  0.21772 
RRRRRRR mmd_lambda:     0.10 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 99.13 +- 0.14 test acc: 87.22 +- 0.54
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32242  2.30551  0.00005  0        0.02225  0.11241  0.10548  3.32213 
0.87860  0.85849  0.99747  0.99914  0.99215  0.98799  11.5486  0.23034  0.10985  0.01900  2000     0.01644  0.99481  0.99356  0.21132 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.32873  2.29965  -0.0000  0        0.02497  0.09757  0.09219  3.32854 
0.87066  0.85763  0.99720  0.99656  0.99039  0.98542  11.5486  0.24462  0.11576  0.02019  2000     0.01643  0.99379  0.99099  0.22442 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10361  0.10891  0.10019  0.10120  0.09956  0.09176  0.00000  3.30222  2.29149  0.00005  0        0.02461  0.09987  0.09648  3.30193 
0.87639  0.86620  0.99747  0.99571  0.99093  0.98113  11.5486  0.23881  0.11413  0.02003  2000     0.01641  0.99420  0.98842  0.21877 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.38853  2.34406  0.00191  0        0.02251  0.10008  0.10806  3.38638 
0.85221  0.84991  0.99756  0.99914  0.99097  0.98456  11.5486  0.23708  0.11311  0.01931  2000     0.01614  0.99427  0.99185  0.21776 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11101  0.11235  0.15049  0.13121  0.14810  0.12349  0.00000  3.32255  2.30866  0.00018  0        0.02483  0.14929  0.12735  3.32214 
0.86873  0.85334  0.99747  0.99571  0.99341  0.98456  11.5486  0.23904  0.11481  0.02056  2000     0.01525  0.99544  0.99013  0.21846 
RRRRRRR mmd_lambda:     0.10 ib_lambda:     1.00   irm_lambda: 10000.00 val acc: 99.10 +- 0.17 test acc: 86.93 +- 0.93
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30383  0.28130  0.28659  0.28473  0.00000  33.2442  2.30551  0.00005  0        0.02237  0.29521  0.28301  3.32213 
0.89498  0.87392  0.99657  0.99914  0.99251  0.98627  11.5486  1.45232  0.06623  0.00716  2000     0.01525  0.99454  0.99271  0.14445 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26372  0.27015  0.24568  0.25557  0.00000  33.3081  2.29965  -0.0000  0        0.02263  0.25470  0.26286  3.32854 
0.90409  0.89451  0.99598  0.99399  0.99233  0.98713  11.5486  1.41653  0.06516  0.00658  2000     0.01532  0.99415  0.99056  0.14093 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12134  0.12349  0.19750  0.21097  0.18712  0.17838  0.00000  33.0421  2.29149  0.00005  0        0.02233  0.19231  0.19468  3.30193 
0.90080  0.89108  0.99666  0.99399  0.99179  0.98542  11.5486  1.47845  0.06774  0.00715  2000     0.01522  0.99422  0.98970  0.14707 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11918  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8889  2.34406  0.00191  0        0.02273  0.19795  0.20797  3.38638 
0.88415  0.87135  0.99625  0.99828  0.99156  0.98627  11.5486  1.55508  0.07087  0.00751  2000     0.01522  0.99391  0.99228  0.15469 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11115  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2444  2.30866  0.00018  0        0.02214  0.19716  0.18096  3.32214 
0.90549  0.89108  0.99580  0.99656  0.99395  0.98970  11.5486  1.36564  0.06453  0.00651  2000     0.01516  0.99488  0.99313  0.13585 
RRRRRRR mmd_lambda:     0.10 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 99.17 +- 0.13 test acc: 89.79 +- 0.78
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2236  2.30551  0.00005  0        0.02259  0.29530  0.28301  3.32213 
0.88925  0.87135  0.99648  0.99742  0.99174  0.98713  11.5486  1.47591  0.06766  0.00709  2000     0.01524  0.99411  0.99228  0.14687 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26350  0.27015  0.24563  0.25471  0.00000  33.2876  2.29965  -0.0000  0        0.02351  0.25456  0.26243  3.32854 
0.90287  0.89279  0.99630  0.99656  0.99188  0.98456  11.5486  1.42377  0.06542  0.00655  2000     0.01634  0.99409  0.99056  0.14171 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12264  0.19709  0.21012  0.18658  0.17753  0.00000  33.0217  2.29149  0.00005  0        0.02416  0.19183  0.19382  3.30193 
0.90278  0.89622  0.99679  0.99399  0.99237  0.98542  11.5486  1.46901  0.06748  0.00719  2000     0.01745  0.99458  0.98970  0.14617 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8681  2.34406  0.00191  0        0.02516  0.19795  0.20797  3.38638 
0.89169  0.87993  0.99580  0.99742  0.99260  0.98627  11.5486  1.51043  0.06918  0.00732  2000     0.01742  0.99420  0.99185  0.15030 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2238  2.30866  0.00018  0        0.02361  0.19716  0.18096  3.32214 
0.90662  0.89108  0.99630  0.99399  0.99409  0.98885  11.5486  1.32047  0.06257  0.00626  2000     0.01628  0.99519  0.99142  0.13141 
RRRRRRR mmd_lambda:     0.10 ib_lambda:    10.00   irm_lambda:  1000.00 val acc: 99.12 +- 0.09 test acc: 89.86 +- 0.69
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2216  2.30551  0.00005  0        0.02364  0.29530  0.28301  3.32213 
0.88727  0.87478  0.99639  0.99828  0.99138  0.98713  11.5486  1.48135  0.06784  0.00714  2000     0.01639  0.99388  0.99271  0.14742 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26345  0.27015  0.24563  0.25471  0.00000  33.2856  2.29965  -0.0000  0        0.02338  0.25454  0.26243  3.32854 
0.90486  0.90308  0.99589  0.99399  0.99264  0.98370  11.5486  1.43787  0.06611  0.00667  2000     0.01649  0.99427  0.98885  0.14312 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12264  0.19709  0.21012  0.18658  0.17753  0.00000  33.0196  2.29149  0.00005  0        0.02543  0.19183  0.19382  3.30193 
0.89606  0.88679  0.99657  0.99313  0.99228  0.98113  11.5486  1.49027  0.06821  0.00718  2000     0.01517  0.99442  0.98713  0.14830 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8660  2.34406  0.00191  0        0.02228  0.19795  0.20797  3.38638 
0.89142  0.88507  0.99643  0.99828  0.99224  0.98885  11.5486  1.51055  0.06897  0.00732  2000     0.01512  0.99433  0.99356  0.15032 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2218  2.30866  0.00018  0        0.02325  0.19716  0.18096  3.32214 
0.90716  0.90051  0.99594  0.99656  0.99372  0.98713  11.5486  1.33061  0.06296  0.00633  2000     0.01514  0.99483  0.99185  0.13242 
RRRRRRR mmd_lambda:     0.10 ib_lambda:    10.00   irm_lambda: 10000.00 val acc: 99.08 +- 0.24 test acc: 89.74 +- 0.76
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12112  0.10806  0.11160  0.10891  0.11417  0.10377  0.00000  0.35509  2.30551  0.00005  0        0.02223  0.11289  0.10634  3.32213 
0.19266  0.18610  0.72305  0.72898  0.67925  0.66209  11.5486  0.18031  1.06340  0.00485  2000     0.01598  0.70115  0.69554  1.64971 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.35559  2.29965  -0.0000  0        0.02253  0.09757  0.09219  3.32854 
0.14322  0.13636  0.76771  0.77015  0.71128  0.69125  11.5486  0.19660  1.14493  0.00741  2000     0.01521  0.73950  0.73070  1.77921 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10377  0.10019  0.10120  0.09974  0.09005  0.00000  0.35294  2.29149  0.00005  0        0.02246  0.09996  0.09562  3.30193 
0.19180  0.18353  0.70298  0.70240  0.65917  0.64150  11.5486  0.19035  1.11353  0.00694  2000     0.01589  0.68108  0.67195  1.72450 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.36374  2.34406  0.00191  0        0.02478  0.10008  0.10806  3.38638 
0.18639  0.17924  0.69747  0.71612  0.65263  0.66380  11.5486  0.18830  1.10396  0.00659  2000     0.01641  0.67505  0.68996  1.70849 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.35525  2.30866  0.00018  0        0.02497  0.10360  0.08790  3.32214 
0.18454  0.18181  0.70496  0.69725  0.65823  0.65008  11.5486  0.19413  1.13524  0.00731  2000     0.01645  0.68159  0.67367  1.75647 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     0.10   irm_lambda:   100.00 val acc: 69.24 +- 2.12 test acc: 17.97 +- 1.85
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33457  2.30551  0.00005  0        0.02227  0.11289  0.10634  3.32213 
0.18598  0.18010  0.71850  0.72384  0.67393  0.65952  11.5486  0.17666  1.11136  0.00410  2000     0.01618  0.69621  0.69168  1.71450 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33511  2.29965  -0.0000  0        0.02362  0.09757  0.09219  3.32854 
0.13280  0.13036  0.76970  0.77701  0.71033  0.68867  11.5486  0.19317  1.20208  0.00645  2000     0.01628  0.74001  0.73284  1.85518 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33254  2.29149  0.00005  0        0.02334  0.09996  0.09562  3.30193 
0.18490  0.17667  0.65489  0.65952  0.61384  0.59691  11.5486  0.18675  1.16659  0.00616  2000     0.01629  0.63436  0.62821  1.79427 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34289  2.34406  0.00191  0        0.02358  0.10008  0.10806  3.38638 
0.17962  0.16809  0.69770  0.71612  0.65191  0.66123  11.5486  0.18620  1.16320  0.00609  2000     0.01635  0.67480  0.68867  1.78950 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33470  2.30866  0.00018  0        0.02357  0.10360  0.08790  3.32214 
0.18152  0.18867  0.69472  0.69125  0.64997  0.63893  11.5486  0.18788  1.17512  0.00603  2000     0.01642  0.67235  0.66509  1.80676 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 68.13 +- 3.44 test acc: 17.30 +- 2.02
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33250  2.30551  0.00005  0        0.02355  0.11289  0.10634  3.32213 
0.18734  0.18096  0.71696  0.72041  0.67311  0.66123  11.5486  0.17622  1.11686  0.00395  2000     0.01640  0.69504  0.69082  1.72161 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33305  2.29965  -0.0000  0        0.02439  0.09757  0.09219  3.32854 
0.13054  0.12607  0.77606  0.78130  0.71516  0.69039  11.5486  0.19314  1.21023  0.00639  2000     0.01641  0.74561  0.73584  1.86630 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33048  2.29149  0.00005  0        0.02360  0.09996  0.09562  3.30193 
0.18472  0.17753  0.65340  0.65694  0.61298  0.59605  11.5486  0.18631  1.17215  0.00604  2000     0.01635  0.63319  0.62650  1.80149 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34078  2.34406  0.00191  0        0.02382  0.10008  0.10806  3.38638 
0.18017  0.16895  0.69761  0.71612  0.65173  0.66123  11.5486  0.18583  1.16933  0.00597  2000     0.01632  0.67467  0.68867  1.79742 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33263  2.30866  0.00018  0        0.02332  0.10360  0.08790  3.32214 
0.18066  0.18782  0.69323  0.68867  0.64862  0.63722  11.5486  0.18754  1.18040  0.00600  2000     0.01631  0.67093  0.66295  1.81423 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     0.10   irm_lambda: 10000.00 val acc: 68.10 +- 3.59 test acc: 17.27 +- 2.12
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.34501  2.30551  0.00005  0        0.02416  0.11241  0.10548  3.32213 
0.87797  0.86192  0.99747  0.99914  0.99242  0.98627  11.5486  0.23173  0.10983  0.01921  2000     0.01633  0.99494  0.99271  0.21162 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35127  2.29965  -0.0000  0        0.02348  0.09757  0.09219  3.32854 
0.87085  0.86878  0.99747  0.99656  0.98994  0.98284  11.5486  0.24500  0.11493  0.02039  2000     0.01646  0.99370  0.98970  0.22367 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10891  0.10019  0.10120  0.09965  0.09176  0.00000  3.32468  2.29149  0.00005  0        0.02515  0.09992  0.09648  3.30193 
0.87477  0.85934  0.99783  0.99571  0.99160  0.98370  11.5486  0.23743  0.11282  0.02011  2000     0.01636  0.99472  0.98970  0.21639 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41148  2.34406  0.00191  0        0.02223  0.10008  0.10806  3.38638 
0.85614  0.84819  0.99733  0.99914  0.99106  0.98456  11.5486  0.23525  0.11162  0.01934  2000     0.01519  0.99420  0.99185  0.21499 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11155  0.11235  0.15279  0.13293  0.14936  0.12693  0.00000  3.34518  2.30866  0.00018  0        0.02276  0.15108  0.12993  3.32214 
0.87008  0.86106  0.99715  0.99571  0.99305  0.98542  11.5486  0.23996  0.11425  0.02081  2000     0.01563  0.99510  0.99056  0.21822 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.09 +- 0.12 test acc: 87.00 +- 0.75
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32449  2.30551  0.00005  0        0.02230  0.11241  0.10548  3.32213 
0.87644  0.85248  0.99733  0.99914  0.99188  0.98627  11.5486  0.23197  0.11059  0.01901  2000     0.01543  0.99460  0.99271  0.21287 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33080  2.29965  -0.0000  0        0.02246  0.09757  0.09219  3.32854 
0.86827  0.85506  0.99693  0.99742  0.98998  0.98284  11.5486  0.24544  0.11605  0.02026  2000     0.01604  0.99345  0.99013  0.22507 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10357  0.10891  0.10019  0.10120  0.09956  0.09176  0.00000  3.30428  2.29149  0.00005  0        0.02075  0.09987  0.09648  3.30193 
0.87829  0.87392  0.99783  0.99485  0.99115  0.98456  11.5486  0.23834  0.11384  0.02005  2000     0.01520  0.99449  0.98970  0.21820 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39063  2.34406  0.00191  0        0.02237  0.10008  0.10806  3.38638 
0.85885  0.85334  0.99724  0.99828  0.99129  0.98713  11.5486  0.23581  0.11267  0.01921  2000     0.01522  0.99427  0.99271  0.21650 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11106  0.11235  0.15103  0.13207  0.14823  0.12521  0.00000  3.32463  2.30866  0.00018  0        0.02282  0.14963  0.12864  3.32214 
0.87193  0.85677  0.99729  0.99571  0.99372  0.98370  11.5486  0.23737  0.11427  0.02049  2000     0.01517  0.99551  0.98970  0.21678 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 99.10 +- 0.14 test acc: 87.08 +- 0.69
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32242  2.30551  0.00005  0        0.02221  0.11241  0.10548  3.32213 
0.87698  0.85334  0.99760  0.99914  0.99210  0.98885  11.5486  0.23199  0.11060  0.01902  2000     0.01514  0.99485  0.99399  0.21295 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.32874  2.29965  -0.0000  0        0.02274  0.09757  0.09219  3.32854 
0.87238  0.86363  0.99747  0.99656  0.99021  0.98284  11.5486  0.24318  0.11498  0.02015  2000     0.01528  0.99384  0.98970  0.22302 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10977  0.10019  0.10120  0.09956  0.09176  0.00000  3.30222  2.29149  0.00005  0        0.02222  0.09987  0.09648  3.30193 
0.88072  0.87564  0.99788  0.99485  0.99192  0.98542  11.5486  0.23641  0.11301  0.01992  2000     0.01518  0.99490  0.99013  0.21648 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.38853  2.34406  0.00191  0        0.02253  0.10008  0.10806  3.38638 
0.85957  0.85506  0.99738  0.99828  0.99129  0.98456  11.5486  0.23670  0.11295  0.01928  2000     0.01518  0.99433  0.99142  0.21741 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11101  0.11235  0.15049  0.13121  0.14810  0.12349  0.00000  3.32255  2.30866  0.00018  0        0.02220  0.14929  0.12735  3.32214 
0.87202  0.85763  0.99729  0.99485  0.99287  0.98627  11.5486  0.24045  0.11534  0.02055  2000     0.01451  0.99508  0.99056  0.21989 
RRRRRRR mmd_lambda:     1.00 ib_lambda:     1.00   irm_lambda: 10000.00 val acc: 99.12 +- 0.15 test acc: 87.23 +- 0.71
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30383  0.28130  0.28659  0.28473  0.00000  33.2442  2.30551  0.00005  0        0.01880  0.29521  0.28301  3.32213 
0.87500  0.86964  0.99571  0.99656  0.99079  0.98284  11.5486  1.54698  0.07055  0.00739  2000     0.01388  0.99325  0.98970  0.15389 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26372  0.27015  0.24568  0.25557  0.00000  33.3081  2.29965  -0.0000  0        0.01875  0.25470  0.26286  3.32854 
0.90657  0.90051  0.99625  0.99485  0.99251  0.98627  11.5486  1.38637  0.06374  0.00651  2000     0.01390  0.99438  0.99056  0.13793 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12134  0.12349  0.19750  0.21097  0.18712  0.17838  0.00000  33.0421  2.29149  0.00005  0        0.02080  0.19231  0.19468  3.30193 
0.89990  0.88936  0.99661  0.99313  0.99228  0.98370  11.5486  1.48637  0.06807  0.00721  2000     0.01386  0.99445  0.98842  0.14785 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11918  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8889  2.34406  0.00191  0        0.02082  0.19795  0.20797  3.38638 
0.88740  0.87993  0.99612  0.99828  0.99165  0.98627  11.5486  1.54268  0.07049  0.00736  2000     0.01403  0.99388  0.99228  0.15346 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11115  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2444  2.30866  0.00018  0        0.01901  0.19716  0.18096  3.32214 
0.90603  0.89451  0.99571  0.99656  0.99445  0.98627  11.5486  1.33317  0.06317  0.00625  2000     0.01424  0.99508  0.99142  0.13263 
RRRRRRR mmd_lambda:     1.00 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 99.05 +- 0.13 test acc: 89.50 +- 1.21
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2236  2.30551  0.00005  0        0.02175  0.29530  0.28301  3.32213 
0.89155  0.86878  0.99621  0.99914  0.99147  0.98199  11.5486  1.46207  0.06693  0.00708  2000     0.01452  0.99384  0.99056  0.14549 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26350  0.27015  0.24563  0.25471  0.00000  33.2876  2.29965  -0.0000  0        0.02101  0.25456  0.26243  3.32854 
0.90202  0.88422  0.99585  0.99399  0.99260  0.98370  11.5486  1.38899  0.06412  0.00649  2000     0.01433  0.99422  0.98885  0.13824 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12264  0.19709  0.21012  0.18658  0.17753  0.00000  33.0217  2.29149  0.00005  0        0.02109  0.19183  0.19382  3.30193 
0.90396  0.89708  0.99639  0.99485  0.99282  0.98113  11.5486  1.46222  0.06695  0.00717  2000     0.01437  0.99460  0.98799  0.14549 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8681  2.34406  0.00191  0        0.02086  0.19795  0.20797  3.38638 
0.89281  0.89279  0.99643  0.99828  0.99210  0.98713  11.5486  1.51055  0.06900  0.00729  2000     0.01424  0.99427  0.99271  0.15031 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2238  2.30866  0.00018  0        0.02100  0.19716  0.18096  3.32214 
0.86764  0.85763  0.99499  0.99571  0.98687  0.98370  11.5486  1.73662  0.08087  0.00753  2000     0.01413  0.99093  0.98970  0.17290 
RRRRRRR mmd_lambda:     1.00 ib_lambda:    10.00   irm_lambda:  1000.00 val acc: 99.00 +- 0.16 test acc: 89.16 +- 1.29
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2216  2.30551  0.00005  0        0.02103  0.29530  0.28301  3.32213 
0.88853  0.87221  0.99594  0.99914  0.99093  0.98799  11.5486  1.53397  0.07015  0.00736  2000     0.01418  0.99343  0.99356  0.15266 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26345  0.27015  0.24563  0.25471  0.00000  33.2856  2.29965  -0.0000  0        0.02133  0.25454  0.26243  3.32854 
0.90143  0.88936  0.99571  0.99485  0.99165  0.98284  11.5486  1.42583  0.06554  0.00656  2000     0.01463  0.99368  0.98885  0.14192 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12264  0.19709  0.21012  0.18658  0.17753  0.00000  33.0196  2.29149  0.00005  0        0.02112  0.19183  0.19382  3.30193 
0.90134  0.89279  0.99666  0.99313  0.99300  0.98456  11.5486  1.47418  0.06726  0.00733  2000     0.01441  0.99483  0.98885  0.14668 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8660  2.34406  0.00191  0        0.02190  0.19795  0.20797  3.38638 
0.89908  0.88507  0.99666  0.99828  0.99323  0.98799  11.5486  1.46358  0.06703  0.00719  2000     0.01480  0.99494  0.99313  0.14563 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2218  2.30866  0.00018  0        0.02374  0.19716  0.18096  3.32214 
0.90346  0.89622  0.99589  0.99571  0.99345  0.98456  11.5486  1.38809  0.06544  0.00658  2000     0.01483  0.99467  0.99013  0.13815 
RRRRRRR mmd_lambda:     1.00 ib_lambda:    10.00   irm_lambda: 10000.00 val acc: 99.09 +- 0.21 test acc: 89.88 +- 0.53
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12112  0.10806  0.11160  0.10891  0.11417  0.10377  0.00000  0.35510  2.30551  0.00005  0        0.02197  0.11289  0.10634  3.32213 
0.19131  0.18353  0.72350  0.73070  0.67925  0.66295  11.5486  0.18033  1.06331  0.00488  2000     0.01477  0.70138  0.69682  1.64960 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.35559  2.29965  -0.0000  0        0.02141  0.09757  0.09219  3.32854 
0.14232  0.13636  0.77254  0.77873  0.71344  0.69125  11.5486  0.19659  1.14519  0.00739  2000     0.01557  0.74299  0.73499  1.77921 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10109  0.10377  0.10019  0.10120  0.09974  0.09005  0.00000  0.35294  2.29149  0.00005  0        0.02188  0.09996  0.09562  3.30193 
0.19248  0.18439  0.70212  0.70154  0.65854  0.64150  11.5486  0.19031  1.11316  0.00695  2000     0.01463  0.68033  0.67152  1.72392 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.36374  2.34406  0.00191  0        0.02168  0.10008  0.10806  3.38638 
0.18486  0.17924  0.69743  0.71612  0.65232  0.66466  11.5486  0.18821  1.10293  0.00661  2000     0.01480  0.67487  0.69039  1.70729 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.35526  2.30866  0.00018  0        0.02203  0.10360  0.08790  3.32214 
0.18499  0.18353  0.71191  0.70325  0.66445  0.65351  11.5486  0.19410  1.13492  0.00733  2000     0.01478  0.68818  0.67838  1.75587 
RRRRRRR mmd_lambda:    10.00 ib_lambda:     0.10   irm_lambda:   100.00 val acc: 69.44 +- 2.21 test acc: 17.92 +- 1.87
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12085  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33457  2.30551  0.00005  0        0.02151  0.11289  0.10634  3.32213 
0.18761  0.18181  0.71723  0.72126  0.67343  0.65952  11.5486  0.17660  1.11137  0.00406  2000     0.01480  0.69533  0.69039  1.71425 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33512  2.29965  -0.0000  0        0.02146  0.09757  0.09219  3.32854 
0.13542  0.13293  0.76650  0.77444  0.70853  0.68782  11.5486  0.19312  1.20251  0.00638  2000     0.01473  0.73751  0.73113  1.85528 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33254  2.29149  0.00005  0        0.02370  0.09996  0.09562  3.30193 
0.18499  0.17753  0.65502  0.65780  0.61447  0.59605  11.5486  0.18670  1.16615  0.00616  2000     0.01579  0.63475  0.62693  1.79368 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34289  2.34406  0.00191  0        0.02299  0.10008  0.10806  3.38638 
0.17913  0.16638  0.69765  0.71612  0.65182  0.66209  11.5486  0.18611  1.16225  0.00612  2000     0.01580  0.67474  0.68910  1.78830 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33471  2.30866  0.00018  0        0.02360  0.10360  0.08790  3.32214 
0.18152  0.18953  0.69734  0.69211  0.65191  0.64236  11.5486  0.18774  1.17416  0.00601  2000     0.01675  0.67462  0.66723  1.80552 
RRRRRRR mmd_lambda:    10.00 ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 68.10 +- 3.40 test acc: 17.37 +- 1.94
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33250  2.30551  0.00005  0        0.02526  0.11289  0.10634  3.32213 
0.18630  0.18181  0.71791  0.72470  0.67388  0.66037  11.5486  0.17620  1.11624  0.00400  2000     0.01647  0.69589  0.69253  1.72082 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33305  2.29965  -0.0000  0        0.02314  0.09757  0.09219  3.32854 
0.13122  0.13036  0.77529  0.78216  0.71534  0.69211  11.5486  0.19302  1.20950  0.00637  2000     0.01551  0.74532  0.73713  1.86518 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33048  2.29149  0.00005  0        0.02198  0.09996  0.09562  3.30193 
0.18517  0.17581  0.65764  0.65952  0.61763  0.59605  11.5486  0.18627  1.17160  0.00605  2000     0.01473  0.63763  0.62778  1.80083 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34078  2.34406  0.00191  0        0.02156  0.10008  0.10806  3.38638 
0.17949  0.16809  0.69765  0.71612  0.65196  0.66209  11.5486  0.18580  1.16894  0.00598  2000     0.01473  0.67480  0.68910  1.79690 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33263  2.30866  0.00018  0        0.02209  0.10360  0.08790  3.32214 
0.18048  0.18867  0.69734  0.69211  0.65191  0.64150  11.5486  0.18747  1.17993  0.00597  2000     0.01470  0.67462  0.66681  1.81366 
RRRRRRR mmd_lambda:    10.00 ib_lambda:     0.10   irm_lambda: 10000.00 val acc: 68.27 +- 3.57 test acc: 17.25 +- 2.08
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.34502  2.30551  0.00005  0        0.02133  0.11241  0.10548  3.32213 
0.87459  0.85420  0.99774  0.99914  0.99210  0.98456  11.5486  0.23404  0.11075  0.01926  2000     0.01536  0.99492  0.99185  0.21387 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35128  2.29965  -0.0000  0        0.02395  0.09757  0.09219  3.32854 
0.87080  0.86020  0.99697  0.99742  0.99025  0.98027  11.5486  0.24484  0.11498  0.02042  2000     0.01486  0.99361  0.98885  0.22348 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10348  0.10891  0.10019  0.10120  0.09965  0.09176  0.00000  3.32468  2.29149  0.00005  0        0.02137  0.09992  0.09648  3.30193 
0.87680  0.86706  0.99779  0.99485  0.99124  0.98456  11.5486  0.23739  0.11272  0.02017  2000     0.01483  0.99451  0.98970  0.21629 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41149  2.34406  0.00191  0        0.02170  0.10008  0.10806  3.38638 
0.86318  0.85934  0.99747  0.99914  0.99156  0.98456  11.5486  0.23539  0.11178  0.01941  2000     0.01481  0.99451  0.99185  0.21506 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11155  0.11235  0.15275  0.13293  0.14936  0.12693  0.00000  3.34518  2.30866  0.00018  0        0.02196  0.15105  0.12993  3.32214 
0.87256  0.86277  0.99742  0.99656  0.99309  0.98542  11.5486  0.23874  0.11373  0.02071  2000     0.01465  0.99526  0.99099  0.21710 
RRRRRRR mmd_lambda:    10.00 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.07 +- 0.12 test acc: 87.16 +- 0.47
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32449  2.30551  0.00005  0        0.02158  0.11241  0.10548  3.32213 
0.87477  0.85677  0.99760  0.99914  0.99169  0.98456  11.5486  0.23359  0.11113  0.01913  2000     0.01462  0.99465  0.99185  0.21437 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33081  2.29965  -0.0000  0        0.02248  0.09757  0.09219  3.32854 
0.87161  0.86535  0.99751  0.99742  0.99030  0.98370  11.5486  0.24430  0.11547  0.02026  2000     0.01577  0.99391  0.99056  0.22393 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10891  0.10019  0.10120  0.09956  0.09176  0.00000  3.30428  2.29149  0.00005  0        0.02373  0.09987  0.09648  3.30193 
0.87757  0.86964  0.99738  0.99571  0.99156  0.98456  11.5486  0.23785  0.11362  0.01999  2000     0.01578  0.99447  0.99013  0.21776 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39064  2.34406  0.00191  0        0.02407  0.10008  0.10806  3.38638 
0.85731  0.84991  0.99747  0.99914  0.99142  0.98456  11.5486  0.23570  0.11264  0.01924  2000     0.01532  0.99445  0.99185  0.21635 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11110  0.11235  0.15103  0.13207  0.14823  0.12521  0.00000  3.32463  2.30866  0.00018  0        0.02160  0.14963  0.12864  3.32214 
0.86900  0.86106  0.99724  0.99656  0.99287  0.98542  11.5486  0.24048  0.11517  0.02060  2000     0.01468  0.99506  0.99099  0.21978 
RRRRRRR mmd_lambda:    10.00 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 99.11 +- 0.07 test acc: 87.01 +- 0.70
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32242  2.30551  0.00005  0        0.02373  0.11241  0.10548  3.32213 
0.87752  0.85334  0.99747  0.99914  0.99228  0.98799  11.5486  0.22984  0.10966  0.01889  2000     0.01514  0.99488  0.99356  0.21094 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.32874  2.29965  -0.0000  0        0.02196  0.09757  0.09219  3.32854 
0.87297  0.85849  0.99702  0.99656  0.99016  0.98370  11.5486  0.24546  0.11604  0.02023  2000     0.01500  0.99359  0.99013  0.22521 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10977  0.10019  0.10120  0.09956  0.09176  0.00000  3.30222  2.29149  0.00005  0        0.02143  0.09987  0.09648  3.30193 
0.87685  0.86964  0.99774  0.99485  0.99142  0.98456  11.5486  0.23677  0.11323  0.01993  2000     0.01458  0.99458  0.98970  0.21682 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.38853  2.34406  0.00191  0        0.02157  0.10008  0.10806  3.38638 
0.85682  0.84991  0.99733  0.99914  0.99106  0.98542  11.5486  0.23441  0.11206  0.01920  2000     0.01463  0.99420  0.99228  0.21520 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11106  0.11235  0.15049  0.13121  0.14805  0.12349  0.00000  3.32256  2.30866  0.00018  0        0.02161  0.14927  0.12735  3.32214 
0.87085  0.85934  0.99742  0.99571  0.99300  0.98713  11.5486  0.23900  0.11479  0.02058  2000     0.01458  0.99521  0.99142  0.21840 
RRRRRRR mmd_lambda:    10.00 ib_lambda:     1.00   irm_lambda: 10000.00 val acc: 99.14 +- 0.14 test acc: 87.10 +- 0.75
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30383  0.28130  0.28659  0.28473  0.00000  33.2442  2.30551  0.00005  0        0.02242  0.29521  0.28301  3.32213 
0.88790  0.87650  0.99616  0.99742  0.99201  0.98970  11.5486  1.48095  0.06790  0.00711  2000     0.01461  0.99409  0.99356  0.14732 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26372  0.27015  0.24568  0.25557  0.00000  33.3081  2.29965  -0.0000  0        0.02153  0.25470  0.26286  3.32854 
0.90513  0.89622  0.99557  0.99485  0.99264  0.98627  11.5486  1.37452  0.06357  0.00633  2000     0.01458  0.99411  0.99056  0.13676 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12134  0.12349  0.19750  0.21097  0.18712  0.17838  0.00000  33.0421  2.29149  0.00005  0        0.01990  0.19231  0.19468  3.30193 
0.90170  0.88679  0.99666  0.99485  0.99305  0.98456  11.5486  1.46017  0.06682  0.00712  2000     0.01460  0.99485  0.98970  0.14524 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11918  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8889  2.34406  0.00191  0        0.01930  0.19795  0.20797  3.38638 
0.89638  0.89279  0.99661  0.99914  0.99309  0.98713  11.5486  1.44500  0.06647  0.00689  2000     0.01487  0.99485  0.99313  0.14375 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11115  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2444  2.30866  0.00018  0        0.02280  0.19716  0.18096  3.32214 
0.90242  0.89622  0.99530  0.99313  0.99382  0.98885  11.5486  1.31875  0.06327  0.00596  2000     0.01472  0.99456  0.99099  0.13122 
RRRRRRR mmd_lambda:    10.00 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 99.16 +- 0.15 test acc: 89.87 +- 0.61
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2236  2.30551  0.00005  0        0.02158  0.29530  0.28301  3.32213 
0.88614  0.87478  0.99661  0.99742  0.99133  0.98799  11.5486  1.52181  0.06950  0.00734  2000     0.01466  0.99397  0.99271  0.15143 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26350  0.27015  0.24563  0.25471  0.00000  33.2876  2.29965  -0.0000  0        0.02165  0.25456  0.26243  3.32854 
0.90337  0.89193  0.99566  0.99485  0.99183  0.98627  11.5486  1.42600  0.06569  0.00656  2000     0.01542  0.99375  0.99056  0.14193 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12264  0.19709  0.21012  0.18662  0.17753  0.00000  33.0217  2.29149  0.00005  0        0.02252  0.19186  0.19382  3.30193 
0.89836  0.89108  0.99598  0.99142  0.99215  0.98199  11.5486  1.47648  0.06731  0.00721  2000     0.01570  0.99406  0.98670  0.14691 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8681  2.34406  0.00191  0        0.02259  0.19795  0.20797  3.38638 
0.89160  0.88336  0.99630  0.99742  0.99215  0.98627  11.5486  1.52902  0.06974  0.00768  2000     0.01579  0.99422  0.99185  0.15212 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2239  2.30866  0.00018  0        0.02291  0.19716  0.18096  3.32214 
0.90766  0.89879  0.99603  0.99485  0.99418  0.98456  11.5486  1.31193  0.06228  0.00615  2000     0.01575  0.99510  0.98970  0.13057 
RRRRRRR mmd_lambda:    10.00 ib_lambda:    10.00   irm_lambda:  1000.00 val acc: 99.03 +- 0.21 test acc: 89.74 +- 0.78
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2216  2.30551  0.00005  0        0.02245  0.29530  0.28301  3.32213 
0.88433  0.86449  0.99652  0.99828  0.99111  0.98885  11.5486  1.53304  0.07014  0.00747  2000     0.01566  0.99382  0.99356  0.15255 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26345  0.27015  0.24563  0.25471  0.00000  33.2856  2.29965  -0.0000  0        0.02291  0.25454  0.26243  3.32854 
0.89638  0.89365  0.99566  0.99485  0.99016  0.98370  11.5486  1.50543  0.06912  0.00669  2000     0.01471  0.99291  0.98928  0.14987 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12264  0.19714  0.21012  0.18658  0.17753  0.00000  33.0196  2.29149  0.00005  0        0.02169  0.19186  0.19382  3.30193 
0.90062  0.88850  0.99684  0.99485  0.99219  0.98113  11.5486  1.48655  0.06796  0.00744  2000     0.01471  0.99451  0.98799  0.14790 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8660  2.34406  0.00191  0        0.02201  0.19795  0.20797  3.38638 
0.88551  0.87993  0.99607  0.99742  0.99215  0.98542  11.5486  1.56182  0.07155  0.00746  2000     0.01475  0.99411  0.99142  0.15543 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2218  2.30866  0.00018  0        0.02156  0.19716  0.18096  3.32214 
0.90238  0.90051  0.99566  0.99742  0.99372  0.98456  11.5486  1.33944  0.06376  0.00625  2000     0.01462  0.99469  0.99099  0.13331 
RRRRRRR mmd_lambda:    10.00 ib_lambda:    10.00   irm_lambda: 10000.00 val acc: 99.07 +- 0.19 test acc: 89.38 +- 0.76
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12112  0.10806  0.11160  0.10891  0.11417  0.10377  0.00000  0.35514  2.30551  0.00005  0        0.02140  0.11289  0.10634  3.32213 
0.19546  0.18696  0.72134  0.72384  0.67839  0.66209  11.5486  0.17954  1.05976  0.00469  2000     0.01458  0.69986  0.69296  1.64315 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.35564  2.29965  -0.0000  0        0.01944  0.09757  0.09219  3.32854 
0.14552  0.13893  0.76289  0.76672  0.70645  0.68524  11.5486  0.19577  1.14140  0.00718  2000     0.01519  0.73467  0.72598  1.77244 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10377  0.10019  0.10120  0.09974  0.09005  0.00000  0.35296  2.29149  0.00005  0        0.02285  0.09996  0.09562  3.30193 
0.19302  0.18353  0.69788  0.69468  0.65439  0.63636  11.5486  0.18966  1.11008  0.00680  2000     0.01573  0.67614  0.66552  1.71825 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.36376  2.34406  0.00191  0        0.02244  0.10008  0.10806  3.38638 
0.18801  0.18696  0.69738  0.71526  0.65299  0.66380  11.5486  0.18704  1.09693  0.00641  2000     0.01513  0.67519  0.68953  1.69741 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.35528  2.30866  0.00018  0        0.01969  0.10360  0.08790  3.32214 
0.18752  0.18353  0.71565  0.70411  0.66752  0.65866  11.5486  0.19398  1.13491  0.00721  2000     0.01475  0.69159  0.68138  1.75482 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     0.10   irm_lambda:   100.00 val acc: 69.11 +- 1.99 test acc: 18.19 +- 1.84
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33462  2.30551  0.00005  0        0.02163  0.11289  0.10634  3.32213 
0.18923  0.18353  0.71642  0.72041  0.67180  0.65694  11.5486  0.17592  1.10712  0.00398  2000     0.01434  0.69411  0.68867  1.70738 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33517  2.29965  -0.0000  0        0.02077  0.09757  0.09219  3.32854 
0.13569  0.13379  0.76144  0.76758  0.70356  0.68267  11.5486  0.19251  1.19929  0.00622  2000     0.01473  0.73250  0.72512  1.84981 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10113  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33257  2.29149  0.00005  0        0.02289  0.09996  0.09562  3.30193 
0.18635  0.17924  0.65782  0.65866  0.61758  0.59519  11.5486  0.18620  1.16292  0.00608  2000     0.01482  0.63770  0.62693  1.78847 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34291  2.34406  0.00191  0        0.02097  0.10008  0.10806  3.38638 
0.18161  0.17753  0.69747  0.71612  0.65209  0.66466  11.5486  0.18509  1.15691  0.00591  2000     0.01377  0.67478  0.69039  1.77938 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33473  2.30866  0.00018  0        0.02073  0.10360  0.08790  3.32214 
0.18066  0.18610  0.69585  0.69039  0.65042  0.64065  11.5486  0.18802  1.17678  0.00593  2000     0.01378  0.67314  0.66552  1.80791 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 67.93 +- 3.24 test acc: 17.47 +- 1.98
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33254  2.30551  0.00005  0        0.02090  0.11289  0.10634  3.32213 
0.18770  0.18353  0.71583  0.72041  0.67158  0.65694  11.5486  0.17565  1.11272  0.00393  2000     0.01382  0.69371  0.68867  1.71504 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33310  2.29965  -0.0000  0        0.02066  0.09757  0.09219  3.32854 
0.13113  0.13036  0.75720  0.76329  0.70018  0.68181  11.5486  0.19209  1.20566  0.00606  2000     0.01381  0.72869  0.72255  1.85788 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10109  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33051  2.29149  0.00005  0        0.02097  0.09996  0.09562  3.30193 
0.18436  0.17495  0.65728  0.65694  0.61699  0.59691  11.5486  0.18588  1.16859  0.00603  2000     0.01380  0.63714  0.62693  1.79624 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34081  2.34406  0.00191  0        0.02061  0.10008  0.10806  3.38638 
0.18053  0.17581  0.69756  0.71612  0.65178  0.66380  11.5486  0.18480  1.16276  0.00585  2000     0.01380  0.67467  0.68996  1.78740 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33265  2.30866  0.00018  0        0.02066  0.10360  0.08790  3.32214 
0.18075  0.18524  0.68629  0.68010  0.64393  0.63550  11.5486  0.18762  1.18220  0.00587  2000     0.01384  0.66511  0.65780  1.81507 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     0.10   irm_lambda: 10000.00 val acc: 67.72 +- 3.24 test acc: 17.29 +- 2.10
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.34506  2.30551  0.00005  0        0.02070  0.11241  0.10548  3.32213 
0.87838  0.85420  0.99756  0.99914  0.99242  0.98456  11.5486  0.23137  0.10962  0.01915  2000     0.01382  0.99499  0.99185  0.21130 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35133  2.29965  -0.0000  0        0.01884  0.09757  0.09219  3.32854 
0.87242  0.85849  0.99729  0.99656  0.98994  0.98542  11.5486  0.24307  0.11416  0.02026  2000     0.01379  0.99361  0.99099  0.22185 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10891  0.10019  0.10120  0.09965  0.09176  0.00000  3.32471  2.29149  0.00005  0        0.01878  0.09992  0.09648  3.30193 
0.87572  0.87392  0.99769  0.99571  0.99124  0.98284  11.5486  0.23685  0.11236  0.02011  2000     0.01380  0.99447  0.98928  0.21581 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41151  2.34406  0.00191  0        0.02066  0.10008  0.10806  3.38638 
0.85826  0.84476  0.99742  0.99914  0.99142  0.98627  11.5486  0.23496  0.11145  0.01928  2000     0.01382  0.99442  0.99271  0.21474 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11155  0.11235  0.15275  0.13293  0.14936  0.12693  0.00000  3.34520  2.30866  0.00018  0        0.02061  0.15105  0.12993  3.32214 
0.86841  0.85506  0.99756  0.99571  0.99327  0.98542  11.5486  0.23902  0.11378  0.02083  2000     0.01389  0.99542  0.99056  0.21724 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.11 +- 0.12 test acc: 87.06 +- 0.70
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32454  2.30551  0.00005  0        0.02068  0.11241  0.10548  3.32213 
0.87567  0.85677  0.99733  0.99828  0.99224  0.98799  11.5486  0.23075  0.11006  0.01902  2000     0.01456  0.99479  0.99313  0.21162 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33086  2.29965  -0.0000  0        0.02367  0.09757  0.09219  3.32854 
0.86895  0.86020  0.99715  0.99742  0.98989  0.98370  11.5486  0.24656  0.11648  0.02034  2000     0.01402  0.99352  0.99056  0.22609 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10357  0.10891  0.10019  0.10120  0.09956  0.09176  0.00000  3.30431  2.29149  0.00005  0        0.02086  0.09987  0.09648  3.30193 
0.87472  0.86792  0.99765  0.99571  0.99151  0.98199  11.5486  0.23821  0.11363  0.02004  2000     0.01401  0.99458  0.98885  0.21805 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39066  2.34406  0.00191  0        0.02110  0.10008  0.10806  3.38638 
0.85894  0.85763  0.99769  0.99828  0.99147  0.98456  11.5486  0.23513  0.11227  0.01923  2000     0.01394  0.99458  0.99142  0.21578 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11110  0.11235  0.15103  0.13207  0.14828  0.12521  0.00000  3.32465  2.30866  0.00018  0        0.02056  0.14965  0.12864  3.32214 
0.87459  0.86020  0.99715  0.99571  0.99318  0.98713  11.5486  0.23755  0.11411  0.02054  2000     0.01380  0.99517  0.99142  0.21690 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 99.11 +- 0.14 test acc: 87.06 +- 0.63
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32246  2.30551  0.00005  0        0.02066  0.11241  0.10548  3.32213 
0.87675  0.85677  0.99760  0.99914  0.99219  0.98627  11.5486  0.23181  0.11048  0.01913  2000     0.01383  0.99490  0.99271  0.21264 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.32879  2.29965  -0.0000  0        0.02067  0.09757  0.09219  3.32854 
0.86931  0.85591  0.99715  0.99742  0.99012  0.98027  11.5486  0.24443  0.11564  0.02012  2000     0.01388  0.99363  0.98885  0.22427 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10361  0.10977  0.10019  0.10120  0.09956  0.09176  0.00000  3.30225  2.29149  0.00005  0        0.02090  0.09987  0.09648  3.30193 
0.87707  0.87049  0.99756  0.99571  0.99138  0.98456  11.5486  0.23843  0.11401  0.02004  2000     0.01397  0.99447  0.99013  0.21835 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.38856  2.34406  0.00191  0        0.02085  0.10008  0.10806  3.38638 
0.85984  0.85591  0.99724  0.99914  0.99120  0.98713  11.5486  0.23430  0.11200  0.01916  2000     0.01391  0.99422  0.99313  0.21511 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11101  0.11235  0.15053  0.13207  0.14814  0.12349  0.00000  3.32258  2.30866  0.00018  0        0.02073  0.14934  0.12778  3.32214 
0.87094  0.85934  0.99729  0.99571  0.99341  0.98627  11.5486  0.23875  0.11468  0.02057  2000     0.01391  0.99535  0.99099  0.21814 
RRRRRRR mmd_lambda:   100.00 ib_lambda:     1.00   irm_lambda: 10000.00 val acc: 99.12 +- 0.16 test acc: 87.08 +- 0.63
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30383  0.28130  0.28659  0.28473  0.00000  33.2442  2.30551  0.00005  0        0.02076  0.29521  0.28301  3.32213 
0.88339  0.85934  0.99652  0.99656  0.99088  0.98713  11.5486  1.53310  0.07002  0.00752  2000     0.01391  0.99370  0.99185  0.15247 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26372  0.27015  0.24568  0.25557  0.00000  33.3082  2.29965  -0.0000  0        0.02083  0.25470  0.26286  3.32854 
0.89611  0.89365  0.99571  0.99571  0.99129  0.98627  11.5486  1.46262  0.06714  0.00668  2000     0.01424  0.99350  0.99099  0.14551 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12134  0.12349  0.19745  0.21097  0.18712  0.17838  0.00000  33.0421  2.29149  0.00005  0        0.02281  0.19229  0.19468  3.30193 
0.90274  0.89536  0.99679  0.99399  0.99264  0.98456  11.5486  1.44584  0.06640  0.00713  2000     0.01491  0.99472  0.98928  0.14379 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11918  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8890  2.34406  0.00191  0        0.02326  0.19795  0.20797  3.38638 
0.88925  0.87564  0.99603  0.99828  0.99174  0.98370  11.5486  1.50316  0.06913  0.00718  2000     0.01488  0.99388  0.99099  0.14951 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11115  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2444  2.30866  0.00018  0        0.02070  0.19716  0.18096  3.32214 
0.90707  0.89622  0.99603  0.99656  0.99431  0.98799  11.5486  1.32970  0.06304  0.00631  2000     0.01386  0.99517  0.99228  0.13226 
RRRRRRR mmd_lambda:   100.00 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 99.11 +- 0.10 test acc: 89.57 +- 0.86
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13614  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2237  2.30551  0.00005  0        0.02097  0.29530  0.28301  3.32213 
0.89480  0.87821  0.99661  0.99828  0.99255  0.99142  11.5486  1.44347  0.06639  0.00700  2000     0.01407  0.99458  0.99485  0.14362 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26354  0.27015  0.24563  0.25471  0.00000  33.2877  2.29965  -0.0000  0        0.02092  0.25459  0.26243  3.32854 
0.90080  0.89279  0.99594  0.99399  0.99224  0.98627  11.5486  1.41393  0.06513  0.00651  2000     0.01384  0.99409  0.99013  0.14071 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12121  0.12264  0.19709  0.21012  0.18662  0.17753  0.00000  33.0217  2.29149  0.00005  0        0.02105  0.19186  0.19382  3.30193 
0.90436  0.89622  0.99715  0.99399  0.99305  0.98627  11.5486  1.45031  0.06639  0.00719  2000     0.01379  0.99510  0.99013  0.14428 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8681  2.34406  0.00191  0        0.02078  0.19795  0.20797  3.38638 
0.89020  0.88078  0.99625  0.99828  0.99224  0.98713  11.5486  1.51589  0.06983  0.00730  2000     0.01382  0.99424  0.99271  0.15083 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2239  2.30866  0.00018  0        0.02080  0.19716  0.18096  3.32214 
0.90364  0.89365  0.99594  0.99656  0.99409  0.98713  11.5486  1.32680  0.06299  0.00648  2000     0.01382  0.99501  0.99185  0.13200 
RRRRRRR mmd_lambda:   100.00 ib_lambda:    10.00   irm_lambda:  1000.00 val acc: 99.19 +- 0.18 test acc: 89.88 +- 0.54
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13614  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2216  2.30551  0.00005  0        0.01870  0.29530  0.28301  3.32213 
0.89466  0.87993  0.99666  0.99828  0.99282  0.99142  11.5486  1.42561  0.06545  0.00700  2000     0.01381  0.99474  0.99485  0.14184 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26350  0.27015  0.24563  0.25471  0.00000  33.2856  2.29965  -0.0000  0        0.02091  0.25456  0.26243  3.32854 
0.90517  0.88936  0.99544  0.99485  0.99228  0.98627  11.5486  1.42553  0.06541  0.00666  2000     0.01381  0.99386  0.99056  0.14186 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12264  0.19709  0.21012  0.18658  0.17753  0.00000  33.0197  2.29149  0.00005  0        0.02061  0.19183  0.19382  3.30193 
0.90287  0.89193  0.99679  0.99228  0.99224  0.98627  11.5486  1.47979  0.06768  0.00725  2000     0.01380  0.99451  0.98928  0.14723 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8660  2.34406  0.00191  0        0.01874  0.19795  0.20797  3.38638 
0.88997  0.87993  0.99612  0.99828  0.99124  0.98542  11.5486  1.55477  0.07125  0.00738  2000     0.01384  0.99368  0.99185  0.15471 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2218  2.30866  0.00018  0        0.02110  0.19716  0.18096  3.32214 
0.90590  0.89022  0.99612  0.99742  0.99400  0.98627  11.5486  1.33179  0.06306  0.00631  2000     0.01382  0.99506  0.99185  0.13252 
RRRRRRR mmd_lambda:   100.00 ib_lambda:    10.00   irm_lambda: 10000.00 val acc: 99.17 +- 0.19 test acc: 89.97 +- 0.63
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12112  0.10806  0.11160  0.10891  0.11417  0.10377  0.00000  0.35556  2.30551  0.00005  0        0.02079  0.11289  0.10634  3.32213 
0.21206  0.21612  0.72247  0.72898  0.68146  0.66552  11.5486  0.17584  1.04612  0.00363  2000     0.01380  0.70196  0.69725  1.61523 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.35616  2.29965  -0.0000  0        0.02061  0.09757  0.09219  3.32854 
0.14999  0.15094  0.70753  0.69554  0.65593  0.63293  11.5486  0.19022  1.11758  0.00586  2000     0.01380  0.68173  0.66423  1.72918 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10118  0.10377  0.10019  0.10120  0.09974  0.09005  0.00000  0.35322  2.29149  0.00005  0        0.02065  0.09996  0.09562  3.30193 
0.19577  0.18953  0.71087  0.70926  0.66359  0.64751  11.5486  0.18547  1.08718  0.00610  2000     0.01381  0.68723  0.67838  1.68211 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.36402  2.34406  0.00191  0        0.01866  0.10008  0.10806  3.38638 
0.20101  0.20325  0.69734  0.71526  0.65426  0.66466  11.5486  0.18296  1.07571  0.00578  2000     0.01381  0.67580  0.68996  1.66191 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.35551  2.30866  0.00018  0        0.02066  0.10360  0.08790  3.32214 
0.18937  0.19382  0.67203  0.66981  0.63116  0.60977  11.5486  0.19030  1.12344  0.00602  2000     0.01387  0.65159  0.63979  1.72775 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:     0.10   irm_lambda:   100.00 val acc: 67.39 +- 2.04 test acc: 18.96 +- 2.12
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12076  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33503  2.30551  0.00005  0        0.01877  0.11289  0.10634  3.32213 
0.20367  0.20669  0.71326  0.71869  0.67289  0.65694  11.5486  0.17237  1.09317  0.00298  2000     0.01398  0.69308  0.68782  1.67929 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33569  2.29965  -0.0000  0        0.02083  0.09757  0.09219  3.32854 
0.14155  0.14065  0.70641  0.69554  0.65272  0.63036  11.5486  0.18669  1.17141  0.00494  2000     0.01462  0.67956  0.66295  1.80129 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10118  0.10377  0.10019  0.10120  0.09974  0.09005  0.00000  0.33283  2.29149  0.00005  0        0.02331  0.09996  0.09562  3.30193 
0.19419  0.18353  0.69657  0.69725  0.65367  0.63464  11.5486  0.18306  1.14559  0.00544  2000     0.01498  0.67512  0.66595  1.76011 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34317  2.34406  0.00191  0        0.02281  0.10008  0.10806  3.38638 
0.19609  0.19811  0.69738  0.71612  0.65367  0.66466  11.5486  0.18021  1.13119  0.00505  2000     0.01488  0.67553  0.69039  1.73632 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33496  2.30866  0.00018  0        0.02322  0.10360  0.08790  3.32214 
0.20110  0.20669  0.66603  0.65180  0.62787  0.62264  11.5486  0.18909  1.19082  0.00543  2000     0.01487  0.64695  0.63722  1.82004 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:     0.10   irm_lambda:  1000.00 val acc: 66.89 +- 1.93 test acc: 18.73 +- 2.31
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12080  0.10891  0.11160  0.10891  0.11417  0.10377  0.00000  0.33296  2.30551  0.00005  0        0.01984  0.11289  0.10634  3.32213 
0.20493  0.20669  0.71304  0.71869  0.67217  0.65780  11.5486  0.17186  1.09769  0.00288  2000     0.01490  0.69260  0.68825  1.68507 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  0.33362  2.29965  -0.0000  0        0.01996  0.09757  0.09219  3.32854 
0.14056  0.14065  0.70528  0.69382  0.65178  0.62778  11.5486  0.18630  1.17640  0.00490  2000     0.01495  0.67853  0.66080  1.80831 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10118  0.10463  0.10019  0.10120  0.09974  0.09005  0.00000  0.33077  2.29149  0.00005  0        0.02036  0.09996  0.09562  3.30193 
0.19329  0.18181  0.69567  0.69639  0.65277  0.63464  11.5486  0.18275  1.15077  0.00541  2000     0.01486  0.67422  0.66552  1.76740 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  0.34106  2.34406  0.00191  0        0.02001  0.10008  0.10806  3.38638 
0.19433  0.19554  0.69738  0.71612  0.65367  0.66466  11.5486  0.18004  1.13737  0.00502  2000     0.01486  0.67553  0.69039  1.74503 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10028  0.10291  0.10199  0.08061  0.10520  0.09519  0.00000  0.33288  2.30866  0.00018  0        0.02308  0.10360  0.08790  3.32214 
0.19771  0.20240  0.66161  0.64579  0.62141  0.61235  11.5486  0.18854  1.19547  0.00532  2000     0.01486  0.64151  0.62907  1.82628 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:     0.10   irm_lambda: 10000.00 val acc: 66.68 +- 2.23 test acc: 18.62 +- 2.32
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.34548  2.30551  0.00005  0        0.01991  0.11241  0.10548  3.32213 
0.87585  0.85591  0.99765  0.99914  0.99224  0.98713  11.5486  0.22981  0.10895  0.01906  2000     0.01487  0.99494  0.99313  0.20965 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.35185  2.29965  -0.0000  0        0.01999  0.09757  0.09219  3.32854 
0.87581  0.87221  0.99738  0.99571  0.99111  0.98456  11.5486  0.24042  0.11323  0.02022  2000     0.01486  0.99424  0.99013  0.21905 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10343  0.10891  0.10019  0.10120  0.09965  0.09176  0.00000  3.32497  2.29149  0.00005  0        0.02036  0.09992  0.09648  3.30193 
0.87666  0.87049  0.99774  0.99399  0.99147  0.98542  11.5486  0.23668  0.11244  0.02011  2000     0.01484  0.99460  0.98970  0.21546 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.41177  2.34406  0.00191  0        0.01994  0.10008  0.10806  3.38638 
0.85835  0.85420  0.99751  0.99914  0.99156  0.98627  11.5486  0.23308  0.11064  0.01924  2000     0.01492  0.99454  0.99271  0.21273 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11155  0.11149  0.15261  0.13293  0.14927  0.12693  0.00000  3.34543  2.30866  0.00018  0        0.02100  0.15094  0.12993  3.32214 
0.87500  0.86964  0.99756  0.99656  0.99345  0.98542  11.5486  0.23581  0.11260  0.02059  2000     0.01452  0.99551  0.99099  0.21410 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:     1.00   irm_lambda:   100.00 val acc: 99.13 +- 0.14 test acc: 87.23 +- 0.70
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32495  2.30551  0.00005  0        0.02064  0.11241  0.10548  3.32213 
0.87373  0.85163  0.99769  0.99914  0.99147  0.98970  11.5486  0.23266  0.11076  0.01907  2000     0.01383  0.99458  0.99442  0.21330 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.33137  2.29965  -0.0000  0        0.02073  0.09757  0.09219  3.32854 
0.87166  0.86449  0.99720  0.99742  0.99034  0.98456  11.5486  0.24027  0.11392  0.01998  2000     0.01386  0.99377  0.99099  0.21997 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10357  0.10977  0.10019  0.10120  0.09951  0.09176  0.00000  3.30457  2.29149  0.00005  0        0.02064  0.09985  0.09648  3.30193 
0.87964  0.87221  0.99760  0.99485  0.99129  0.98370  11.5486  0.23528  0.11267  0.01989  2000     0.01381  0.99445  0.98928  0.21510 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.39092  2.34406  0.00191  0        0.01903  0.10008  0.10806  3.38638 
0.85921  0.85334  0.99711  0.99914  0.99147  0.98627  11.5486  0.23277  0.11149  0.01915  2000     0.01383  0.99429  0.99271  0.21333 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11106  0.11149  0.15099  0.13207  0.14828  0.12521  0.00000  3.32488  2.30866  0.00018  0        0.01896  0.14963  0.12864  3.32214 
0.87098  0.85677  0.99751  0.99656  0.99368  0.98542  11.5486  0.23713  0.11371  0.02050  2000     0.01383  0.99560  0.99099  0.21632 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:     1.00   irm_lambda:  1000.00 val acc: 99.17 +- 0.17 test acc: 87.10 +- 0.67
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11412  0.10034  0.11160  0.10891  0.11323  0.10205  0.00000  3.32288  2.30551  0.00005  0        0.01876  0.11241  0.10548  3.32213 
0.87716  0.85934  0.99760  0.99914  0.99242  0.98970  11.5486  0.23023  0.11001  0.01897  2000     0.01383  0.99501  0.99442  0.21106 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.09784  0.09777  0.09766  0.09176  0.09748  0.09262  0.00000  3.32931  2.29965  -0.0000  0        0.02064  0.09757  0.09219  3.32854 
0.87698  0.87135  0.99742  0.99742  0.99039  0.98456  11.5486  0.24113  0.11426  0.02000  2000     0.01380  0.99391  0.99099  0.22089 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10352  0.10977  0.10019  0.10120  0.09956  0.09176  0.00000  3.30251  2.29149  0.00005  0        0.02068  0.09987  0.09648  3.30193 
0.87915  0.86964  0.99751  0.99485  0.99169  0.98370  11.5486  0.23474  0.11247  0.01987  2000     0.01378  0.99460  0.98928  0.21466 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10510  0.10463  0.09775  0.10291  0.10240  0.11320  0.00000  3.38881  2.34406  0.00191  0        0.02060  0.10008  0.10806  3.38638 
0.86128  0.85420  0.99733  0.99914  0.99151  0.98713  11.5486  0.23197  0.11120  0.01905  2000     0.01463  0.99442  0.99313  0.21270 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11101  0.11235  0.15067  0.13207  0.14819  0.12349  0.00000  3.32281  2.30866  0.00018  0        0.02276  0.14943  0.12778  3.32214 
0.87671  0.86878  0.99756  0.99656  0.99345  0.98627  11.5486  0.23644  0.11355  0.02047  2000     0.01489  0.99551  0.99142  0.21574 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:     1.00   irm_lambda: 10000.00 val acc: 99.19 +- 0.18 test acc: 87.43 +- 0.65
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13618  0.16895  0.30392  0.28130  0.28668  0.28473  0.00000  33.2446  2.30551  0.00005  0        0.02109  0.29530  0.28301  3.32213 
0.89002  0.87307  0.99648  0.99742  0.99165  0.98970  11.5486  1.50786  0.06874  0.00739  2000     0.01383  0.99406  0.99356  0.14981 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26363  0.27015  0.24563  0.25471  0.00000  33.3087  2.29965  -0.0000  0        0.02064  0.25463  0.26243  3.32854 
0.90418  0.90051  0.99648  0.99571  0.99255  0.98027  11.5486  1.39994  0.06453  0.00652  2000     0.01380  0.99451  0.98799  0.13911 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12134  0.12349  0.19736  0.21012  0.18699  0.17753  0.00000  33.0424  2.29149  0.00005  0        0.02116  0.19217  0.19382  3.30193 
0.90053  0.89965  0.99634  0.99142  0.99237  0.98456  11.5486  1.47373  0.06726  0.00708  2000     0.01382  0.99436  0.98799  0.14642 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11918  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8892  2.34406  0.00191  0        0.02073  0.19795  0.20797  3.38638 
0.88948  0.87478  0.99594  0.99828  0.99269  0.98627  11.5486  1.50012  0.06850  0.00717  2000     0.01399  0.99431  0.99228  0.14906 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11115  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2446  2.30866  0.00018  0        0.02110  0.19716  0.18096  3.32214 
0.90481  0.88850  0.99607  0.99571  0.99391  0.98885  11.5486  1.32909  0.06269  0.00626  2000     0.01388  0.99499  0.99228  0.13203 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:    10.00   irm_lambda:   100.00 val acc: 99.08 +- 0.24 test acc: 89.78 +- 0.67
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13614  0.16895  0.30392  0.28130  0.28664  0.28473  0.00000  33.2241  2.30551  0.00005  0        0.02041  0.29528  0.28301  3.32213 
0.88988  0.87821  0.99661  0.99828  0.99151  0.98713  11.5486  1.47982  0.06734  0.00731  2000     0.01459  0.99406  0.99271  0.14706 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26336  0.27015  0.24563  0.25471  0.00000  33.2882  2.29965  -0.0000  0        0.02219  0.25450  0.26243  3.32854 
0.90775  0.89022  0.99566  0.99485  0.99305  0.98627  11.5486  1.38990  0.06399  0.00654  2000     0.01466  0.99436  0.99056  0.13816 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12125  0.12349  0.19700  0.21012  0.18667  0.17838  0.00000  33.0220  2.29149  0.00005  0        0.02070  0.19183  0.19425  3.30193 
0.90188  0.89022  0.99652  0.99485  0.99224  0.98284  11.5486  1.49763  0.06830  0.00732  2000     0.01413  0.99438  0.98885  0.14883 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8684  2.34406  0.00191  0        0.02304  0.19795  0.20797  3.38638 
0.88366  0.88078  0.99652  0.99742  0.99169  0.98542  11.5486  1.53306  0.06983  0.00740  2000     0.01429  0.99411  0.99142  0.15237 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2241  2.30866  0.00018  0        0.02076  0.19716  0.18096  3.32214 
0.90432  0.89365  0.99612  0.99656  0.99377  0.98542  11.5486  1.34055  0.06315  0.00641  2000     0.01451  0.99494  0.99099  0.13322 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:    10.00   irm_lambda:  1000.00 val acc: 99.09 +- 0.13 test acc: 89.75 +- 0.92
RRRRRRR args.seed:  0     args.trial_seed:  0
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.13614  0.16895  0.30392  0.28130  0.28664  0.28473  0.00000  33.2220  2.30551  0.00005  0        0.02183  0.29528  0.28301  3.32213 
0.88799  0.86964  0.99661  0.99742  0.99151  0.98799  11.5486  1.49932  0.06836  0.00727  2000     0.01467  0.99406  0.99271  0.14903 
RRRRRRR args.seed:  1     args.trial_seed:  1
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.10497  0.10377  0.26336  0.27015  0.24563  0.25471  0.00000  33.2861  2.29965  -0.0000  0        0.02086  0.25450  0.26243  3.32854 
0.90423  0.90137  0.99634  0.99485  0.99296  0.98542  11.5486  1.43037  0.06567  0.00681  2000     0.01387  0.99465  0.99013  0.14217 
RRRRRRR args.seed:  2     args.trial_seed:  2
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.12130  0.12264  0.19695  0.21012  0.18649  0.17753  0.00000  33.0199  2.29149  0.00005  0        0.02071  0.19172  0.19382  3.30193 
0.90256  0.90137  0.99621  0.99485  0.99255  0.98542  11.5486  1.50663  0.06871  0.00747  2000     0.01524  0.99438  0.99013  0.14972 
RRRRRRR args.seed:  3     args.trial_seed:  3
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11913  0.12178  0.19980  0.21269  0.19610  0.20325  0.00000  33.8663  2.34406  0.00191  0        0.02318  0.19795  0.20797  3.38638 
0.87964  0.86792  0.99548  0.99742  0.99084  0.98542  11.5486  1.59252  0.07272  0.00768  2000     0.01441  0.99316  0.99142  0.15828 
RRRRRRR args.seed:  4     args.trial_seed:  4
LRRRRRRR: 0.1
DECAY STEP: 600
env0_in  env0_ou  env1_in  env1_ou  env2_in  env2_ou  epoch    loss     nll      penalty  step     step_ti  train_a  val_acc  var     
0.11124  0.11320  0.19939  0.18181  0.19492  0.18010  0.00000  33.2220  2.30866  0.00018  0        0.02277  0.19716  0.18096  3.32214 
0.90233  0.89108  0.99607  0.99571  0.99350  0.98627  11.5486  1.35347  0.06402  0.00632  2000     0.01466  0.99479  0.99099  0.13452 
RRRRRRR mmd_lambda:  1000.00 ib_lambda:    10.00   irm_lambda: 10000.00 val acc: 99.11 +- 0.10 test acc: 89.54 +- 0.98
Report with best val performance: val acc:99.19 +- 0.18  test acc:89.88 +- 0.54
Corresponding hypers: {'mmd_lambda': 100, 'ib_lambda': 10, 'irm_lambda': 1000}
